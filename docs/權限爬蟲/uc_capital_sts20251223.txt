2025-12-23 16:47:16.011 +08:00 [DBG] Hosting starting
2025-12-23 16:47:16.136 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerDataProtectionDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:16.158 +08:00 [DBG] Compiling query expression: 
'DbSet<DataProtectionKey>()
    .AsNoTracking()'
2025-12-23 16:47:16.316 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<DataProtectionKey>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: DataProtectionKey.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: DataProtectionKey.FriendlyName (string), 1], [Property: DataProtectionKey.Xml (string), 2] }
        SELECT d.Id, d.FriendlyName, d.Xml
        FROM DataProtectionKeys AS d) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: DataProtectionKey.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: DataProtectionKey.FriendlyName (string), 1], [Property: DataProtectionKey.Xml (string), 2] }
        SELECT d.Id, d.FriendlyName, d.Xml
        FROM DataProtectionKeys AS d, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        DataProtectionKey entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            DataProtectionKey instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(DataProtectionKey);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: DataProtectionKey | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Microsoft.AspNetCore.DataProtection.EntityFrameworkCore.DataProtectionKey")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: DataProtectionKey | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Microsoft.AspNetCore.DataProtection.EntityFrameworkCore.DataProtectionKey")]: 
                        {
                            return 
                            {
                                DataProtectionKey instance;
                                instance = new DataProtectionKey();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<FriendlyName>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                instance.<Xml>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: DataProtectionKey | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Microsoft.AspNetCore.DataProtection.EntityFrameworkCore.DataProtectionKey")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(DataProtectionKey)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: DataProtectionKey | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Microsoft.AspNetCore.DataProtection.EntityFrameworkCore.DataProtectionKey")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: DataProtectionKey.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Microsoft.AspNetCore.DataProtection.EntityFrameworkCore.DataProtectionKey").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        return entity;
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerDataProtectionDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:16.337 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:16.341 +08:00 [DBG] Created DbConnection. (4ms).
2025-12-23 16:47:16.343 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.351 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.354 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.358 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-12-23 16:47:16.360 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-12-23 16:47:16.364 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[FriendlyName], [d].[Xml]
FROM [DataProtectionKeys] AS [d]
2025-12-23 16:47:16.383 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[FriendlyName], [d].[Xml]
FROM [DataProtectionKeys] AS [d]
2025-12-23 16:47:16.387 +08:00 [DBG] Reading data with key 'key-3a3f1e82-f4cf-4f26-8931-74903ec634b9', value '<key id="3a3f1e82-f4cf-4f26-8931-74903ec634b9" version="1"><creationDate>2025-12-19T04:09:12.0078527Z</creationDate><activationDate>2025-12-19T04:09:12.0078527Z</activationDate><expirationDate>2026-03-19T04:09:12.0078527Z</expirationDate><descriptor deserializerType="Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60"><descriptor><encryption algorithm="AES_256_CBC" /><validation algorithm="HMACSHA256" /><masterKey p4:requiresEncryption="true" xmlns:p4="http://schemas.asp.net/2015/03/dataProtection"><!-- Warning: the key below is in an unencrypted form. --><value>nfqvGxTcczom5HGRPm54gNPZoTH+FkB7PY9LW70ULilsVS2p8M9Ou2buIZuPq6bNCG5+YR5v/IoAN3UWc7vcuw==</value></masterKey></descriptor></descriptor></key>'.
2025-12-23 16:47:16.390 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.394 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 8ms reading results.
2025-12-23 16:47:16.395 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.396 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:16.396 +08:00 [DBG] 'IdentityServerDataProtectionDbContext' disposed.
2025-12-23 16:47:16.397 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.397 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:16.404 +08:00 [DBG] Found key {3a3f1e82-f4cf-4f26-8931-74903ec634b9}.
2025-12-23 16:47:16.414 +08:00 [DBG] Considering key {3a3f1e82-f4cf-4f26-8931-74903ec634b9} with expiration date 2026-03-19 04:09:12Z as default key.
2025-12-23 16:47:16.418 +08:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-12-23 16:47:16.421 +08:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-12-23 16:47:16.423 +08:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-12-23 16:47:16.426 +08:00 [DBG] Using key {3a3f1e82-f4cf-4f26-8931-74903ec634b9} as the default key.
2025-12-23 16:47:16.427 +08:00 [DBG] Key ring with default key {3a3f1e82-f4cf-4f26-8931-74903ec634b9} was loaded during application startup.
2025-12-23 16:47:16.434 +08:00 [INF] Starting Duende IdentityServer version 7.3.2+build.0.7d3159f7be1314e01f03a23ad33dd7b665151ee5 (.NET 9.0.0)
2025-12-23 16:47:16.436 +08:00 [WRN] You do not have a valid license key for the Duende software. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please start a conversation with us: https://duendesoftware.com/contact
2025-12-23 16:47:16.439 +08:00 [DBG] Custom IssuerUri set to https://Prs.Uccapital.com.tw/sts
2025-12-23 16:47:16.441 +08:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2025-12-23 16:47:16.441 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2025-12-23 16:47:16.441 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2025-12-23 16:47:16.441 +08:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2025-12-23 16:47:16.441 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2025-12-23 16:47:16.441 +08:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2025-12-23 16:47:16.467 +08:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-12-23 16:47:16.544 +08:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2025-12-23 16:47:16.545 +08:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-12-23 16:47:16.546 +08:00 [DBG] Loaded hosting startup assembly Skoruba.Duende.IdentityServer.STS.Identity
2025-12-23 16:47:16.546 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-23 16:47:16.546 +08:00 [INF] Hosting environment: Production
2025-12-23 16:47:16.546 +08:00 [INF] Content root path: C:\Workspace\PRSWeb\STS
2025-12-23 16:47:16.546 +08:00 [DBG] Hosting started
2025-12-23 16:47:16.557 +08:00 [INF] Request starting HTTP/2 GET https://prs.uccapital.com.tw/sts/connect/authorize?client_id=uc_localhost_5174&redirect_uri=http%3A%2F%2Flocalhost%3A5174%2Fdemo%3Ftab%3Duc-sso%26callback%3Dtrue&response_type=code&scope=openid+profile+email&state=15ffcdc984eb460bae2382ef4f2382f5&code_challenge=zn2rx3ca3h5SKlcDfnWfUeDRS1AWTaxNe4MMw3_l0Qs&code_challenge_method=S256 - null null
2025-12-23 16:47:16.561 +08:00 [DBG] The request path /connect/authorize does not match a supported file type
2025-12-23 16:47:16.576 +08:00 [DBG] Login Url: /Account/Login
2025-12-23 16:47:16.576 +08:00 [DBG] Login Return Url Parameter: ReturnUrl
2025-12-23 16:47:16.576 +08:00 [DBG] Logout Url: /Account/Logout
2025-12-23 16:47:16.576 +08:00 [DBG] ConsentUrl Url: /consent
2025-12-23 16:47:16.576 +08:00 [DBG] Consent Return Url Parameter: returnUrl
2025-12-23 16:47:16.576 +08:00 [DBG] Error Url: /home/error
2025-12-23 16:47:16.576 +08:00 [DBG] Error Id Parameter: errorId
2025-12-23 16:47:16.592 +08:00 [DBG] AuthenticationScheme: Identity.Application was successfully authenticated.
2025-12-23 16:47:16.603 +08:00 [DBG] AuthenticationScheme: Identity.Application was successfully authenticated.
2025-12-23 16:47:16.608 +08:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2025-12-23 16:47:16.615 +08:00 [DBG] Endpoint enabled: Authorize, successfully created handler: Duende.IdentityServer.Endpoints.AuthorizeEndpoint
2025-12-23 16:47:16.619 +08:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.AuthorizeEndpoint for /connect/authorize
2025-12-23 16:47:16.620 +08:00 [DBG] Start authorize request
2025-12-23 16:47:16.626 +08:00 [DBG] User in authorize request: 1bd29909-68f6-4442-bd5b-242240d49a47
2025-12-23 16:47:16.628 +08:00 [DBG] Start authorize request protocol validation
2025-12-23 16:47:16.633 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:16.643 +08:00 [DBG] Compiling query expression: 
'DbSet<Client>()
    .Where(x => x.ClientId == __clientId_0)
    .Include(x => x.AllowedCorsOrigins)
    .Include(x => x.AllowedGrantTypes)
    .Include(x => x.AllowedScopes)
    .Include(x => x.Claims)
    .Include(x => x.ClientSecrets)
    .Include(x => x.IdentityProviderRestrictions)
    .Include(x => x.PostLogoutRedirectUris)
    .Include(x => x.Properties)
    .Include(x => x.RedirectUris)
    .AsNoTracking()
    .AsSplitQuery()'
2025-12-23 16:47:16.663 +08:00 [DBG] Including navigation: 'Client.AllowedCorsOrigins'.
2025-12-23 16:47:16.663 +08:00 [DBG] Including navigation: 'Client.AllowedGrantTypes'.
2025-12-23 16:47:16.664 +08:00 [DBG] Including navigation: 'Client.AllowedScopes'.
2025-12-23 16:47:16.664 +08:00 [DBG] Including navigation: 'Client.Claims'.
2025-12-23 16:47:16.664 +08:00 [DBG] Including navigation: 'Client.ClientSecrets'.
2025-12-23 16:47:16.664 +08:00 [DBG] Including navigation: 'Client.IdentityProviderRestrictions'.
2025-12-23 16:47:16.665 +08:00 [DBG] Including navigation: 'Client.PostLogoutRedirectUris'.
2025-12-23 16:47:16.665 +08:00 [DBG] Including navigation: 'Client.Properties'.
2025-12-23 16:47:16.665 +08:00 [DBG] Including navigation: 'Client.RedirectUris'.
2025-12-23 16:47:16.809 +08:00 [DBG] Generated query execution expression: 
'queryContext => SplitQueryingEnumerable.Create<Client>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Client.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Client.AbsoluteRefreshTokenLifetime (int) Required, 1], [Property: Client.AccessTokenLifetime (int) Required, 2], [Property: Client.AccessTokenType (int) Required, 3], [Property: Client.AllowAccessTokensViaBrowser (bool) Required, 4], [Property: Client.AllowOfflineAccess (bool) Required, 5], [Property: Client.AllowPlainTextPkce (bool) Required, 6], [Property: Client.AllowRememberConsent (bool) Required, 7], [Property: Client.AllowedIdentityTokenSigningAlgorithms (string) MaxLength(100), 8], [Property: Client.AlwaysIncludeUserClaimsInIdToken (bool) Required, 9], [Property: Client.AlwaysSendClientClaims (bool) Required, 10], [Property: Client.AuthorizationCodeLifetime (int) Required, 11], [Property: Client.BackChannelLogoutSessionRequired (bool) Required, 12], [Property: Client.BackChannelLogoutUri (string) MaxLength(2000), 13], [Property: Client.CibaLifetime (int?), 14], [Property: Client.ClientClaimsPrefix (string) MaxLength(200), 15], [Property: Client.ClientId (string) Required Index MaxLength(200), 16], [Property: Client.ClientName (string) MaxLength(200), 17], [Property: Client.ClientUri (string) MaxLength(2000), 18], [Property: Client.ConsentLifetime (int?), 19], [Property: Client.CoordinateLifetimeWithUserSession (bool?), 20], [Property: Client.Created (DateTime) Required, 21], [Property: Client.DPoPClockSkew (TimeSpan) Required, 22], [Property: Client.DPoPValidationMode (DPoPTokenExpirationValidationMode) Required, 23], [Property: Client.Description (string) MaxLength(1000), 24], [Property: Client.DeviceCodeLifetime (int) Required, 25], [Property: Client.EnableLocalLogin (bool) Required, 26], [Property: Client.Enabled (bool) Required, 27], [Property: Client.FrontChannelLogoutSessionRequired (bool) Required, 28], [Property: Client.FrontChannelLogoutUri (string) MaxLength(2000), 29], [Property: Client.IdentityTokenLifetime (int) Required, 30], [Property: Client.IncludeJwtId (bool) Required, 31], [Property: Client.InitiateLoginUri (string) MaxLength(2000), 32], [Property: Client.LastAccessed (DateTime?), 33], [Property: Client.LogoUri (string) MaxLength(2000), 34], [Property: Client.NonEditable (bool) Required, 35], [Property: Client.PairWiseSubjectSalt (string) MaxLength(200), 36], [Property: Client.PollingInterval (int?), 37], [Property: Client.ProtocolType (string) Required MaxLength(200), 38], [Property: Client.PushedAuthorizationLifetime (int?), 39], [Property: Client.RefreshTokenExpiration (int) Required, 40], [Property: Client.RefreshTokenUsage (int) Required, 41], [Property: Client.RequireClientSecret (bool) Required, 42], [Property: Client.RequireConsent (bool) Required, 43], [Property: Client.RequireDPoP (bool) Required, 44], [Property: Client.RequirePkce (bool) Required, 45], [Property: Client.RequirePushedAuthorization (bool) Required, 46], [Property: Client.RequireRequestObject (bool) Required, 47], [Property: Client.SlidingRefreshTokenLifetime (int) Required, 48], [Property: Client.UpdateAccessTokenClaimsOnRefresh (bool) Required, 49], [Property: Client.Updated (DateTime?), 50], [Property: Client.UserCodeType (string) MaxLength(100), 51], [Property: Client.UserSsoLifetime (int?), 52] }
            1 -> 0
        SELECT c.Id, c.AbsoluteRefreshTokenLifetime, c.AccessTokenLifetime, c.AccessTokenType, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.AllowPlainTextPkce, c.AllowRememberConsent, c.AllowedIdentityTokenSigningAlgorithms, c.AlwaysIncludeUserClaimsInIdToken, c.AlwaysSendClientClaims, c.AuthorizationCodeLifetime, c.BackChannelLogoutSessionRequired, c.BackChannelLogoutUri, c.CibaLifetime, c.ClientClaimsPrefix, c.ClientId, c.ClientName, c.ClientUri, c.ConsentLifetime, c.CoordinateLifetimeWithUserSession, c.Created, c.DPoPClockSkew, c.DPoPValidationMode, c.Description, c.DeviceCodeLifetime, c.EnableLocalLogin, c.Enabled, c.FrontChannelLogoutSessionRequired, c.FrontChannelLogoutUri, c.IdentityTokenLifetime, c.IncludeJwtId, c.InitiateLoginUri, c.LastAccessed, c.LogoUri, c.NonEditable, c.PairWiseSubjectSalt, c.PollingInterval, c.ProtocolType, c.PushedAuthorizationLifetime, c.RefreshTokenExpiration, c.RefreshTokenUsage, c.RequireClientSecret, c.RequireConsent, c.RequireDPoP, c.RequirePkce, c.RequirePushedAuthorization, c.RequireRequestObject, c.SlidingRefreshTokenLifetime, c.UpdateAccessTokenClaimsOnRefresh, c.Updated, c.UserCodeType, c.UserSsoLifetime
        FROM Clients AS c
        WHERE c.ClientId == @__clientId_0
        ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Client.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Client.AbsoluteRefreshTokenLifetime (int) Required, 1], [Property: Client.AccessTokenLifetime (int) Required, 2], [Property: Client.AccessTokenType (int) Required, 3], [Property: Client.AllowAccessTokensViaBrowser (bool) Required, 4], [Property: Client.AllowOfflineAccess (bool) Required, 5], [Property: Client.AllowPlainTextPkce (bool) Required, 6], [Property: Client.AllowRememberConsent (bool) Required, 7], [Property: Client.AllowedIdentityTokenSigningAlgorithms (string) MaxLength(100), 8], [Property: Client.AlwaysIncludeUserClaimsInIdToken (bool) Required, 9], [Property: Client.AlwaysSendClientClaims (bool) Required, 10], [Property: Client.AuthorizationCodeLifetime (int) Required, 11], [Property: Client.BackChannelLogoutSessionRequired (bool) Required, 12], [Property: Client.BackChannelLogoutUri (string) MaxLength(2000), 13], [Property: Client.CibaLifetime (int?), 14], [Property: Client.ClientClaimsPrefix (string) MaxLength(200), 15], [Property: Client.ClientId (string) Required Index MaxLength(200), 16], [Property: Client.ClientName (string) MaxLength(200), 17], [Property: Client.ClientUri (string) MaxLength(2000), 18], [Property: Client.ConsentLifetime (int?), 19], [Property: Client.CoordinateLifetimeWithUserSession (bool?), 20], [Property: Client.Created (DateTime) Required, 21], [Property: Client.DPoPClockSkew (TimeSpan) Required, 22], [Property: Client.DPoPValidationMode (DPoPTokenExpirationValidationMode) Required, 23], [Property: Client.Description (string) MaxLength(1000), 24], [Property: Client.DeviceCodeLifetime (int) Required, 25], [Property: Client.EnableLocalLogin (bool) Required, 26], [Property: Client.Enabled (bool) Required, 27], [Property: Client.FrontChannelLogoutSessionRequired (bool) Required, 28], [Property: Client.FrontChannelLogoutUri (string) MaxLength(2000), 29], [Property: Client.IdentityTokenLifetime (int) Required, 30], [Property: Client.IncludeJwtId (bool) Required, 31], [Property: Client.InitiateLoginUri (string) MaxLength(2000), 32], [Property: Client.LastAccessed (DateTime?), 33], [Property: Client.LogoUri (string) MaxLength(2000), 34], [Property: Client.NonEditable (bool) Required, 35], [Property: Client.PairWiseSubjectSalt (string) MaxLength(200), 36], [Property: Client.PollingInterval (int?), 37], [Property: Client.ProtocolType (string) Required MaxLength(200), 38], [Property: Client.PushedAuthorizationLifetime (int?), 39], [Property: Client.RefreshTokenExpiration (int) Required, 40], [Property: Client.RefreshTokenUsage (int) Required, 41], [Property: Client.RequireClientSecret (bool) Required, 42], [Property: Client.RequireConsent (bool) Required, 43], [Property: Client.RequireDPoP (bool) Required, 44], [Property: Client.RequirePkce (bool) Required, 45], [Property: Client.RequirePushedAuthorization (bool) Required, 46], [Property: Client.RequireRequestObject (bool) Required, 47], [Property: Client.SlidingRefreshTokenLifetime (int) Required, 48], [Property: Client.UpdateAccessTokenClaimsOnRefresh (bool) Required, 49], [Property: Client.Updated (DateTime?), 50], [Property: Client.UserCodeType (string) MaxLength(100), 51], [Property: Client.UserSsoLifetime (int?), 52] }
            1 -> 0
        SELECT c.Id, c.AbsoluteRefreshTokenLifetime, c.AccessTokenLifetime, c.AccessTokenType, c.AllowAccessTokensViaBrowser, c.AllowOfflineAccess, c.AllowPlainTextPkce, c.AllowRememberConsent, c.AllowedIdentityTokenSigningAlgorithms, c.AlwaysIncludeUserClaimsInIdToken, c.AlwaysSendClientClaims, c.AuthorizationCodeLifetime, c.BackChannelLogoutSessionRequired, c.BackChannelLogoutUri, c.CibaLifetime, c.ClientClaimsPrefix, c.ClientId, c.ClientName, c.ClientUri, c.ConsentLifetime, c.CoordinateLifetimeWithUserSession, c.Created, c.DPoPClockSkew, c.DPoPValidationMode, c.Description, c.DeviceCodeLifetime, c.EnableLocalLogin, c.Enabled, c.FrontChannelLogoutSessionRequired, c.FrontChannelLogoutUri, c.IdentityTokenLifetime, c.IncludeJwtId, c.InitiateLoginUri, c.LastAccessed, c.LogoUri, c.NonEditable, c.PairWiseSubjectSalt, c.PollingInterval, c.ProtocolType, c.PushedAuthorizationLifetime, c.RefreshTokenExpiration, c.RefreshTokenUsage, c.RequireClientSecret, c.RequireConsent, c.RequireDPoP, c.RequirePkce, c.RequirePushedAuthorization, c.RequireRequestObject, c.SlidingRefreshTokenLifetime, c.UpdateAccessTokenClaimsOnRefresh, c.Updated, c.UserCodeType, c.UserSsoLifetime
        FROM Clients AS c
        WHERE c.ClientId == @__clientId_0
        ORDER BY c.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => resultContext.Values == null ? 
    {
        Client entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Client instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Client);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Client | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Client | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client")]: 
                        {
                            return 
                            {
                                Client instance;
                                instance = new Client();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<AbsoluteRefreshTokenLifetime>k__BackingField = dataReader.GetInt32(1);
                                instance.<AccessTokenLifetime>k__BackingField = dataReader.GetInt32(2);
                                instance.<AccessTokenType>k__BackingField = dataReader.GetInt32(3);
                                instance.<AllowAccessTokensViaBrowser>k__BackingField = dataReader.GetBoolean(4);
                                instance.<AllowOfflineAccess>k__BackingField = dataReader.GetBoolean(5);
                                instance.<AllowPlainTextPkce>k__BackingField = dataReader.GetBoolean(6);
                                instance.<AllowRememberConsent>k__BackingField = dataReader.GetBoolean(7);
                                instance.<AllowedIdentityTokenSigningAlgorithms>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                instance.<AlwaysIncludeUserClaimsInIdToken>k__BackingField = dataReader.GetBoolean(9);
                                instance.<AlwaysSendClientClaims>k__BackingField = dataReader.GetBoolean(10);
                                instance.<AuthorizationCodeLifetime>k__BackingField = dataReader.GetInt32(11);
                                instance.<BackChannelLogoutSessionRequired>k__BackingField = dataReader.GetBoolean(12);
                                instance.<BackChannelLogoutUri>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                instance.<CibaLifetime>k__BackingField = dataReader.IsDBNull(14) ? default(int?) : (int?)dataReader.GetInt32(14);
                                instance.<ClientClaimsPrefix>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<ClientId>k__BackingField = dataReader.GetString(16);
                                instance.<ClientName>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<ClientUri>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                instance.<ConsentLifetime>k__BackingField = dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19);
                                instance.<CoordinateLifetimeWithUserSession>k__BackingField = dataReader.IsDBNull(20) ? default(bool?) : (bool?)dataReader.GetBoolean(20);
                                instance.<Created>k__BackingField = dataReader.GetDateTime(21);
                                instance.<DPoPClockSkew>k__BackingField = dataReader.GetFieldValue<TimeSpan>(22);
                                instance.<DPoPValidationMode>k__BackingField = Invoke(((EnumToNumberConverter<DPoPTokenExpirationValidationMode, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Client.DPoPValidationMode (DPoPTokenExpirationValidationMode) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindProperty("DPoPValidationMode")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(23));
                                instance.<Description>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<DeviceCodeLifetime>k__BackingField = dataReader.GetInt32(25);
                                instance.<EnableLocalLogin>k__BackingField = dataReader.GetBoolean(26);
                                instance.<Enabled>k__BackingField = dataReader.GetBoolean(27);
                                instance.<FrontChannelLogoutSessionRequired>k__BackingField = dataReader.GetBoolean(28);
                                instance.<FrontChannelLogoutUri>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<IdentityTokenLifetime>k__BackingField = dataReader.GetInt32(30);
                                instance.<IncludeJwtId>k__BackingField = dataReader.GetBoolean(31);
                                instance.<InitiateLoginUri>k__BackingField = dataReader.IsDBNull(32) ? default(string) : dataReader.GetString(32);
                                instance.<LastAccessed>k__BackingField = dataReader.IsDBNull(33) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(33);
                                instance.<LogoUri>k__BackingField = dataReader.IsDBNull(34) ? default(string) : dataReader.GetString(34);
                                instance.<NonEditable>k__BackingField = dataReader.GetBoolean(35);
                                instance.<PairWiseSubjectSalt>k__BackingField = dataReader.IsDBNull(36) ? default(string) : dataReader.GetString(36);
                                instance.<PollingInterval>k__BackingField = dataReader.IsDBNull(37) ? default(int?) : (int?)dataReader.GetInt32(37);
                                instance.<ProtocolType>k__BackingField = dataReader.GetString(38);
                                instance.<PushedAuthorizationLifetime>k__BackingField = dataReader.IsDBNull(39) ? default(int?) : (int?)dataReader.GetInt32(39);
                                instance.<RefreshTokenExpiration>k__BackingField = dataReader.GetInt32(40);
                                instance.<RefreshTokenUsage>k__BackingField = dataReader.GetInt32(41);
                                instance.<RequireClientSecret>k__BackingField = dataReader.GetBoolean(42);
                                instance.<RequireConsent>k__BackingField = dataReader.GetBoolean(43);
                                instance.<RequireDPoP>k__BackingField = dataReader.GetBoolean(44);
                                instance.<RequirePkce>k__BackingField = dataReader.GetBoolean(45);
                                instance.<RequirePushedAuthorization>k__BackingField = dataReader.GetBoolean(46);
                                instance.<RequireRequestObject>k__BackingField = dataReader.GetBoolean(47);
                                instance.<SlidingRefreshTokenLifetime>k__BackingField = dataReader.GetInt32(48);
                                instance.<UpdateAccessTokenClaimsOnRefresh>k__BackingField = dataReader.GetBoolean(49);
                                instance.<Updated>k__BackingField = dataReader.IsDBNull(50) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(50);
                                instance.<UserCodeType>k__BackingField = dataReader.IsDBNull(51) ? default(string) : dataReader.GetString(51);
                                instance.<UserSsoLifetime>k__BackingField = dataReader.IsDBNull(52) ? default(int?) : (int?)dataReader.GetInt32(52);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Client | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Client)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Client | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Client.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        resultContext.Values = new object[]{ entity };
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 0, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.AllowedCorsOrigins (List<ClientCorsOrigin>) Collection ToDependent ClientCorsOrigin Inverse: Client | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedCorsOrigins")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientCorsOrigin>, ClientCorsOrigin> | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedCorsOrigins").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 1, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.AllowedGrantTypes (List<ClientGrantType>) Collection ToDependent ClientGrantType Inverse: Client | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedGrantTypes")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientGrantType>, ClientGrantType> | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedGrantTypes").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 2, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.AllowedScopes (List<ClientScope>) Collection ToDependent ClientScope Inverse: Client | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedScopes")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientScope>, ClientScope> | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedScopes").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 3, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.Claims (List<ClientClaim>) Collection ToDependent ClientClaim Inverse: Client | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Claims")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientClaim>, ClientClaim> | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Claims").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 4, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.ClientSecrets (List<ClientSecret>) Collection ToDependent ClientSecret Inverse: Client | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("ClientSecrets")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientSecret>, ClientSecret> | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("ClientSecrets").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 5, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.IdentityProviderRestrictions (List<ClientIdPRestriction>) Collection ToDependent ClientIdPRestriction Inverse: Client | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("IdentityProviderRestrictions")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientIdPRestriction>, ClientIdPRestriction> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("IdentityProviderRestrictions").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 6, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.PostLogoutRedirectUris (List<ClientPostLogoutRedirectUri>) Collection ToDependent ClientPostLogoutRedirectUri Inverse: Client | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("PostLogoutRedirectUris")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientPostLogoutRedirectUri>, ClientPostLogoutRedirectUri> | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("PostLogoutRedirectUris").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 7, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.Properties (List<ClientProperty>) Collection ToDependent ClientProperty Inverse: Client | Resolver: namelessParameter{19} => namelessParameter{19}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Properties")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientProperty>, ClientProperty> | Resolver: namelessParameter{20} => namelessParameter{20}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Properties").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        ShaperProcessingExpressionVisitor.InitializeSplitIncludeCollection<Client, Client>(
            collectionId: 8, 
            queryContext: queryContext, 
            parentDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            entity: (Client)(resultContext.Values[0]), 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            navigation: [LIFTABLE Constant: Navigation: Client.RedirectUris (List<ClientRedirectUri>) Collection ToDependent ClientRedirectUri Inverse: Client | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("RedirectUris")], 
            clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientRedirectUri>, ClientRedirectUri> | Resolver: namelessParameter{22} => namelessParameter{22}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("RedirectUris").GetCollectionAccessor()], 
            trackingQuery: False, 
            setLoaded: True);
        return } : (Client)(resultContext.Values[0]), 
    relatedDataLoaders: null, 
    relatedDataLoadersAsync: (queryContext, executionStrategy, resultCoordinator) => ShaperProcessingExpressionVisitor.TaskAwaiter(new Func<Task>[]
    { 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientCorsOrigin>(
            collectionId: 0, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientCorsOrigin.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientCorsOrigin.ClientId (int) Required FK Index, 1], [Property: ClientCorsOrigin.Origin (string) Required Index MaxLength(150), 2] }
                    1 -> 3
                SELECT c0.Id, c0.ClientId, c0.Origin, c.Id
                FROM Clients AS c
                INNER JOIN ClientCorsOrigins AS c0 ON c.Id == c0.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientCorsOrigin.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientCorsOrigin.ClientId (int) Required FK Index, 1], [Property: ClientCorsOrigin.Origin (string) Required Index MaxLength(150), 2] }
                    1 -> 3
                SELECT c0.Id, c0.ClientId, c0.Origin, c.Id
                FROM Clients AS c
                INNER JOIN ClientCorsOrigins AS c0 ON c.Id == c0.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientCorsOrigin entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ClientCorsOrigin instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ClientCorsOrigin);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ClientCorsOrigin | Resolver: namelessParameter{23} => namelessParameter{23}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ClientCorsOrigin | Resolver: namelessParameter{24} => namelessParameter{24}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin")]: 
                                {
                                    return 
                                    {
                                        ClientCorsOrigin instance;
                                        instance = new ClientCorsOrigin();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Origin>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientCorsOrigin | Resolver: namelessParameter{25} => namelessParameter{25}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientCorsOrigin)
                        }
                        ;
                        return instance2;
                    } : 
                    {
                        object[] keyValues2;
                        keyValues2 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientCorsOrigin | Resolver: namelessParameter{26} => namelessParameter{26}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientCorsOrigin.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin").FindPrimaryKey().Properties], 
                            keyValues: keyValues2);
                    };
                    return instance2;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientCorsOrigin.Client (Client) ToPrincipal Client Inverse: AllowedCorsOrigins | Resolver: namelessParameter{27} => namelessParameter{27}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientCorsOrigin").FindNavigation("Client")], 
            fixup: (namelessParameter{28}, namelessParameter{29}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientCorsOrigin>, ClientCorsOrigin> | Resolver: namelessParameter{30} => namelessParameter{30}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedCorsOrigins").GetCollectionAccessor()].Add(
                    entity: namelessParameter{28}, 
                    value: namelessParameter{29}, 
                    forMaterialization: True);
                return namelessParameter{29}.<Client>k__BackingField = namelessParameter{28};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientGrantType>(
            collectionId: 1, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientGrantType.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientGrantType.ClientId (int) Required FK Index, 1], [Property: ClientGrantType.GrantType (string) Required Index MaxLength(250), 2] }
                    1 -> 3
                SELECT c1.Id, c1.ClientId, c1.GrantType, c.Id
                FROM Clients AS c
                INNER JOIN ClientGrantTypes AS c1 ON c.Id == c1.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientGrantType.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientGrantType.ClientId (int) Required FK Index, 1], [Property: ClientGrantType.GrantType (string) Required Index MaxLength(250), 2] }
                    1 -> 3
                SELECT c1.Id, c1.ClientId, c1.GrantType, c.Id
                FROM Clients AS c
                INNER JOIN ClientGrantTypes AS c1 ON c.Id == c1.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientGrantType entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    ClientGrantType instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(ClientGrantType);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: ClientGrantType | Resolver: namelessParameter{31} => namelessParameter{31}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: ClientGrantType | Resolver: namelessParameter{32} => namelessParameter{32}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType")]: 
                                {
                                    return 
                                    {
                                        ClientGrantType instance;
                                        instance = new ClientGrantType();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<GrantType>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientGrantType | Resolver: namelessParameter{33} => namelessParameter{33}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientGrantType)
                        }
                        ;
                        return instance3;
                    } : 
                    {
                        object[] keyValues3;
                        keyValues3 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientGrantType | Resolver: namelessParameter{34} => namelessParameter{34}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientGrantType.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType").FindPrimaryKey().Properties], 
                            keyValues: keyValues3);
                    };
                    return instance3;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientGrantType.Client (Client) ToPrincipal Client Inverse: AllowedGrantTypes | Resolver: namelessParameter{35} => namelessParameter{35}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientGrantType").FindNavigation("Client")], 
            fixup: (namelessParameter{36}, namelessParameter{37}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientGrantType>, ClientGrantType> | Resolver: namelessParameter{38} => namelessParameter{38}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedGrantTypes").GetCollectionAccessor()].Add(
                    entity: namelessParameter{36}, 
                    value: namelessParameter{37}, 
                    forMaterialization: True);
                return namelessParameter{37}.<Client>k__BackingField = namelessParameter{36};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientScope>(
            collectionId: 2, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientScope.ClientId (int) Required FK Index, 1], [Property: ClientScope.Scope (string) Required Index MaxLength(200), 2] }
                    1 -> 3
                SELECT c2.Id, c2.ClientId, c2.Scope, c.Id
                FROM Clients AS c
                INNER JOIN ClientScopes AS c2 ON c.Id == c2.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientScope.ClientId (int) Required FK Index, 1], [Property: ClientScope.Scope (string) Required Index MaxLength(200), 2] }
                    1 -> 3
                SELECT c2.Id, c2.ClientId, c2.Scope, c.Id
                FROM Clients AS c
                INNER JOIN ClientScopes AS c2 ON c.Id == c2.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientScope entity;
                entity = 
                {
                    MaterializationContext materializationContext4;
                    IEntityType entityType4;
                    ClientScope instance4;
                    materializationContext4 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance4 = default(ClientScope);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot4;
                        shadowSnapshot4 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType4 = [LIFTABLE Constant: EntityType: ClientScope | Resolver: namelessParameter{39} => namelessParameter{39}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope")];
                        instance4 = switch (entityType4)
                        {
                            case [LIFTABLE Constant: EntityType: ClientScope | Resolver: namelessParameter{40} => namelessParameter{40}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope")]: 
                                {
                                    return 
                                    {
                                        ClientScope instance;
                                        instance = new ClientScope();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Scope>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext4.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientScope | Resolver: namelessParameter{41} => namelessParameter{41}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientScope)
                        }
                        ;
                        return instance4;
                    } : 
                    {
                        object[] keyValues4;
                        keyValues4 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientScope | Resolver: namelessParameter{42} => namelessParameter{42}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope").FindPrimaryKey().Properties], 
                            keyValues: keyValues4);
                    };
                    return instance4;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientScope.Client (Client) ToPrincipal Client Inverse: AllowedScopes | Resolver: namelessParameter{43} => namelessParameter{43}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientScope").FindNavigation("Client")], 
            fixup: (namelessParameter{44}, namelessParameter{45}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientScope>, ClientScope> | Resolver: namelessParameter{46} => namelessParameter{46}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("AllowedScopes").GetCollectionAccessor()].Add(
                    entity: namelessParameter{44}, 
                    value: namelessParameter{45}, 
                    forMaterialization: True);
                return namelessParameter{45}.<Client>k__BackingField = namelessParameter{44};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientClaim>(
            collectionId: 3, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientClaim.ClientId (int) Required FK Index, 1], [Property: ClientClaim.Type (string) Required Index MaxLength(250), 2], [Property: ClientClaim.Value (string) Required Index MaxLength(250), 3] }
                    1 -> 4
                SELECT c3.Id, c3.ClientId, c3.Type, c3.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientClaims AS c3 ON c.Id == c3.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientClaim.ClientId (int) Required FK Index, 1], [Property: ClientClaim.Type (string) Required Index MaxLength(250), 2], [Property: ClientClaim.Value (string) Required Index MaxLength(250), 3] }
                    1 -> 4
                SELECT c3.Id, c3.ClientId, c3.Type, c3.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientClaims AS c3 ON c.Id == c3.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(4) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext5;
                    IEntityType entityType5;
                    ClientClaim instance5;
                    materializationContext5 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance5 = default(ClientClaim);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot5;
                        shadowSnapshot5 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType5 = [LIFTABLE Constant: EntityType: ClientClaim | Resolver: namelessParameter{47} => namelessParameter{47}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim")];
                        instance5 = switch (entityType5)
                        {
                            case [LIFTABLE Constant: EntityType: ClientClaim | Resolver: namelessParameter{48} => namelessParameter{48}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim")]: 
                                {
                                    return 
                                    {
                                        ClientClaim instance;
                                        instance = new ClientClaim();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Type>k__BackingField = dataReader.GetString(2);
                                        instance.<Value>k__BackingField = dataReader.GetString(3);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext5.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientClaim | Resolver: namelessParameter{49} => namelessParameter{49}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientClaim)
                        }
                        ;
                        return instance5;
                    } : 
                    {
                        object[] keyValues5;
                        keyValues5 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientClaim | Resolver: namelessParameter{50} => namelessParameter{50}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim").FindPrimaryKey().Properties], 
                            keyValues: keyValues5);
                    };
                    return instance5;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientClaim.Client (Client) ToPrincipal Client Inverse: Claims | Resolver: namelessParameter{51} => namelessParameter{51}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientClaim").FindNavigation("Client")], 
            fixup: (namelessParameter{52}, namelessParameter{53}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientClaim>, ClientClaim> | Resolver: namelessParameter{54} => namelessParameter{54}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Claims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{52}, 
                    value: namelessParameter{53}, 
                    forMaterialization: True);
                return namelessParameter{53}.<Client>k__BackingField = namelessParameter{52};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientSecret>(
            collectionId: 4, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientSecret.ClientId (int) Required FK Index, 1], [Property: ClientSecret.Created (DateTime) Required, 2], [Property: ClientSecret.Description (string) MaxLength(2000), 3], [Property: ClientSecret.Expiration (DateTime?), 4], [Property: ClientSecret.Type (string) Required MaxLength(250), 5], [Property: ClientSecret.Value (string) Required MaxLength(4000), 6] }
                    1 -> 7
                SELECT c4.Id, c4.ClientId, c4.Created, c4.Description, c4.Expiration, c4.Type, c4.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientSecrets AS c4 ON c.Id == c4.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientSecret.ClientId (int) Required FK Index, 1], [Property: ClientSecret.Created (DateTime) Required, 2], [Property: ClientSecret.Description (string) MaxLength(2000), 3], [Property: ClientSecret.Expiration (DateTime?), 4], [Property: ClientSecret.Type (string) Required MaxLength(250), 5], [Property: ClientSecret.Value (string) Required MaxLength(4000), 6] }
                    1 -> 7
                SELECT c4.Id, c4.ClientId, c4.Created, c4.Description, c4.Expiration, c4.Type, c4.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientSecrets AS c4 ON c.Id == c4.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(7) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientSecret entity;
                entity = 
                {
                    MaterializationContext materializationContext6;
                    IEntityType entityType6;
                    ClientSecret instance6;
                    materializationContext6 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance6 = default(ClientSecret);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot6;
                        shadowSnapshot6 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType6 = [LIFTABLE Constant: EntityType: ClientSecret | Resolver: namelessParameter{55} => namelessParameter{55}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret")];
                        instance6 = switch (entityType6)
                        {
                            case [LIFTABLE Constant: EntityType: ClientSecret | Resolver: namelessParameter{56} => namelessParameter{56}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret")]: 
                                {
                                    return 
                                    {
                                        ClientSecret instance;
                                        instance = new ClientSecret();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Created>k__BackingField = dataReader.GetDateTime(2);
                                        instance.<Description>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                        instance.<Expiration>k__BackingField = dataReader.IsDBNull(4) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(4);
                                        instance.<Type>k__BackingField = dataReader.GetString(5);
                                        instance.<Value>k__BackingField = dataReader.GetString(6);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext6.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientSecret | Resolver: namelessParameter{57} => namelessParameter{57}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientSecret)
                        }
                        ;
                        return instance6;
                    } : 
                    {
                        object[] keyValues6;
                        keyValues6 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientSecret | Resolver: namelessParameter{58} => namelessParameter{58}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret").FindPrimaryKey().Properties], 
                            keyValues: keyValues6);
                    };
                    return instance6;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientSecret.Client (Client) ToPrincipal Client Inverse: ClientSecrets | Resolver: namelessParameter{59} => namelessParameter{59}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientSecret").FindNavigation("Client")], 
            fixup: (namelessParameter{60}, namelessParameter{61}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientSecret>, ClientSecret> | Resolver: namelessParameter{62} => namelessParameter{62}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("ClientSecrets").GetCollectionAccessor()].Add(
                    entity: namelessParameter{60}, 
                    value: namelessParameter{61}, 
                    forMaterialization: True);
                return namelessParameter{61}.<Client>k__BackingField = namelessParameter{60};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientIdPRestriction>(
            collectionId: 5, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientIdPRestriction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientIdPRestriction.ClientId (int) Required FK Index, 1], [Property: ClientIdPRestriction.Provider (string) Required Index MaxLength(200), 2] }
                    1 -> 3
                SELECT c5.Id, c5.ClientId, c5.Provider, c.Id
                FROM Clients AS c
                INNER JOIN ClientIdPRestrictions AS c5 ON c.Id == c5.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientIdPRestriction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientIdPRestriction.ClientId (int) Required FK Index, 1], [Property: ClientIdPRestriction.Provider (string) Required Index MaxLength(200), 2] }
                    1 -> 3
                SELECT c5.Id, c5.ClientId, c5.Provider, c.Id
                FROM Clients AS c
                INNER JOIN ClientIdPRestrictions AS c5 ON c.Id == c5.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientIdPRestriction entity;
                entity = 
                {
                    MaterializationContext materializationContext7;
                    IEntityType entityType7;
                    ClientIdPRestriction instance7;
                    materializationContext7 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance7 = default(ClientIdPRestriction);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot7;
                        shadowSnapshot7 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType7 = [LIFTABLE Constant: EntityType: ClientIdPRestriction | Resolver: namelessParameter{63} => namelessParameter{63}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction")];
                        instance7 = switch (entityType7)
                        {
                            case [LIFTABLE Constant: EntityType: ClientIdPRestriction | Resolver: namelessParameter{64} => namelessParameter{64}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction")]: 
                                {
                                    return 
                                    {
                                        ClientIdPRestriction instance;
                                        instance = new ClientIdPRestriction();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Provider>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext7.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientIdPRestriction | Resolver: namelessParameter{65} => namelessParameter{65}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientIdPRestriction)
                        }
                        ;
                        return instance7;
                    } : 
                    {
                        object[] keyValues7;
                        keyValues7 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientIdPRestriction | Resolver: namelessParameter{66} => namelessParameter{66}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientIdPRestriction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction").FindPrimaryKey().Properties], 
                            keyValues: keyValues7);
                    };
                    return instance7;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientIdPRestriction.Client (Client) ToPrincipal Client Inverse: IdentityProviderRestrictions | Resolver: namelessParameter{67} => namelessParameter{67}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientIdPRestriction").FindNavigation("Client")], 
            fixup: (namelessParameter{68}, namelessParameter{69}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientIdPRestriction>, ClientIdPRestriction> | Resolver: namelessParameter{70} => namelessParameter{70}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("IdentityProviderRestrictions").GetCollectionAccessor()].Add(
                    entity: namelessParameter{68}, 
                    value: namelessParameter{69}, 
                    forMaterialization: True);
                return namelessParameter{69}.<Client>k__BackingField = namelessParameter{68};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientPostLogoutRedirectUri>(
            collectionId: 6, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientPostLogoutRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientPostLogoutRedirectUri.ClientId (int) Required FK Index, 1], [Property: ClientPostLogoutRedirectUri.PostLogoutRedirectUri (string) Required Index MaxLength(400), 2] }
                    1 -> 3
                SELECT c6.Id, c6.ClientId, c6.PostLogoutRedirectUri, c.Id
                FROM Clients AS c
                INNER JOIN ClientPostLogoutRedirectUris AS c6 ON c.Id == c6.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientPostLogoutRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientPostLogoutRedirectUri.ClientId (int) Required FK Index, 1], [Property: ClientPostLogoutRedirectUri.PostLogoutRedirectUri (string) Required Index MaxLength(400), 2] }
                    1 -> 3
                SELECT c6.Id, c6.ClientId, c6.PostLogoutRedirectUri, c.Id
                FROM Clients AS c
                INNER JOIN ClientPostLogoutRedirectUris AS c6 ON c.Id == c6.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientPostLogoutRedirectUri entity;
                entity = 
                {
                    MaterializationContext materializationContext8;
                    IEntityType entityType8;
                    ClientPostLogoutRedirectUri instance8;
                    materializationContext8 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance8 = default(ClientPostLogoutRedirectUri);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot8;
                        shadowSnapshot8 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType8 = [LIFTABLE Constant: EntityType: ClientPostLogoutRedirectUri | Resolver: namelessParameter{71} => namelessParameter{71}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri")];
                        instance8 = switch (entityType8)
                        {
                            case [LIFTABLE Constant: EntityType: ClientPostLogoutRedirectUri | Resolver: namelessParameter{72} => namelessParameter{72}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri")]: 
                                {
                                    return 
                                    {
                                        ClientPostLogoutRedirectUri instance;
                                        instance = new ClientPostLogoutRedirectUri();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<PostLogoutRedirectUri>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext8.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientPostLogoutRedirectUri | Resolver: namelessParameter{73} => namelessParameter{73}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientPostLogoutRedirectUri)
                        }
                        ;
                        return instance8;
                    } : 
                    {
                        object[] keyValues8;
                        keyValues8 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientPostLogoutRedirectUri | Resolver: namelessParameter{74} => namelessParameter{74}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientPostLogoutRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri").FindPrimaryKey().Properties], 
                            keyValues: keyValues8);
                    };
                    return instance8;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientPostLogoutRedirectUri.Client (Client) ToPrincipal Client Inverse: PostLogoutRedirectUris | Resolver: namelessParameter{75} => namelessParameter{75}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientPostLogoutRedirectUri").FindNavigation("Client")], 
            fixup: (namelessParameter{76}, namelessParameter{77}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientPostLogoutRedirectUri>, ClientPostLogoutRedirectUri> | Resolver: namelessParameter{78} => namelessParameter{78}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("PostLogoutRedirectUris").GetCollectionAccessor()].Add(
                    entity: namelessParameter{76}, 
                    value: namelessParameter{77}, 
                    forMaterialization: True);
                return namelessParameter{77}.<Client>k__BackingField = namelessParameter{76};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientProperty>(
            collectionId: 7, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientProperty.ClientId (int) Required FK Index, 1], [Property: ClientProperty.Key (string) Required Index MaxLength(250), 2], [Property: ClientProperty.Value (string) Required MaxLength(2000), 3] }
                    1 -> 4
                SELECT c7.Id, c7.ClientId, c7.Key, c7.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientProperties AS c7 ON c.Id == c7.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientProperty.ClientId (int) Required FK Index, 1], [Property: ClientProperty.Key (string) Required Index MaxLength(250), 2], [Property: ClientProperty.Value (string) Required MaxLength(2000), 3] }
                    1 -> 4
                SELECT c7.Id, c7.ClientId, c7.Key, c7.Value, c.Id
                FROM Clients AS c
                INNER JOIN ClientProperties AS c7 ON c.Id == c7.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(4) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext9;
                    IEntityType entityType9;
                    ClientProperty instance9;
                    materializationContext9 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance9 = default(ClientProperty);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot9;
                        shadowSnapshot9 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType9 = [LIFTABLE Constant: EntityType: ClientProperty | Resolver: namelessParameter{79} => namelessParameter{79}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty")];
                        instance9 = switch (entityType9)
                        {
                            case [LIFTABLE Constant: EntityType: ClientProperty | Resolver: namelessParameter{80} => namelessParameter{80}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty")]: 
                                {
                                    return 
                                    {
                                        ClientProperty instance;
                                        instance = new ClientProperty();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<Key>k__BackingField = dataReader.GetString(2);
                                        instance.<Value>k__BackingField = dataReader.GetString(3);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext9.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientProperty | Resolver: namelessParameter{81} => namelessParameter{81}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientProperty)
                        }
                        ;
                        return instance9;
                    } : 
                    {
                        object[] keyValues9;
                        keyValues9 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientProperty | Resolver: namelessParameter{82} => namelessParameter{82}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty").FindPrimaryKey().Properties], 
                            keyValues: keyValues9);
                    };
                    return instance9;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientProperty.Client (Client) ToPrincipal Client Inverse: Properties | Resolver: namelessParameter{83} => namelessParameter{83}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientProperty").FindNavigation("Client")], 
            fixup: (namelessParameter{84}, namelessParameter{85}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientProperty>, ClientProperty> | Resolver: namelessParameter{86} => namelessParameter{86}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{84}, 
                    value: namelessParameter{85}, 
                    forMaterialization: True);
                return namelessParameter{85}.<Client>k__BackingField = namelessParameter{84};
            }, 
            trackingQuery: False), 
        () => ShaperProcessingExpressionVisitor.PopulateSplitIncludeCollectionAsync<Client, ClientRedirectUri>(
            collectionId: 8, 
            queryContext: (RelationalQueryContext)queryContext, 
            executionStrategy: executionStrategy, 
            relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientRedirectUri.ClientId (int) Required FK Index, 1], [Property: ClientRedirectUri.RedirectUri (string) Required Index MaxLength(400), 2] }
                    1 -> 3
                SELECT c8.Id, c8.ClientId, c8.RedirectUri, c.Id
                FROM Clients AS c
                INNER JOIN ClientRedirectUris AS c8 ON c.Id == c8.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC) | Resolver: c => new RelationalCommandCache(
                c.Dependencies.MemoryCache, 
                c.RelationalDependencies.QuerySqlGeneratorFactory, 
                c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
                Client Projections:
                    0 -> Dictionary<IProperty, int> { [Property: ClientRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ClientRedirectUri.ClientId (int) Required FK Index, 1], [Property: ClientRedirectUri.RedirectUri (string) Required Index MaxLength(400), 2] }
                    1 -> 3
                SELECT c8.Id, c8.ClientId, c8.RedirectUri, c.Id
                FROM Clients AS c
                INNER JOIN ClientRedirectUris AS c8 ON c.Id == c8.ClientId
                WHERE c.ClientId == @__clientId_0
                ORDER BY c.Id ASC, 
                False, 
                new HashSet<string>(
                    new string[]{ }, 
                    StringComparer.Ordinal
                )
            )].GetRelationalCommandTemplate(parameters), 
            readerColumns: null, 
            detailedErrorsEnabled: False, 
            resultCoordinator: resultCoordinator, 
            childIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(3) }], 
            identifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ClientRedirectUri entity;
                entity = 
                {
                    MaterializationContext materializationContext10;
                    IEntityType entityType10;
                    ClientRedirectUri instance10;
                    materializationContext10 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance10 = default(ClientRedirectUri);
                    (object)dataReader.GetInt32(0) != null ? 
                    {
                        ISnapshot shadowSnapshot10;
                        shadowSnapshot10 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType10 = [LIFTABLE Constant: EntityType: ClientRedirectUri | Resolver: namelessParameter{87} => namelessParameter{87}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri")];
                        instance10 = switch (entityType10)
                        {
                            case [LIFTABLE Constant: EntityType: ClientRedirectUri | Resolver: namelessParameter{88} => namelessParameter{88}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri")]: 
                                {
                                    return 
                                    {
                                        ClientRedirectUri instance;
                                        instance = new ClientRedirectUri();
                                        instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                        instance.<ClientId>k__BackingField = dataReader.GetInt32(1);
                                        instance.<RedirectUri>k__BackingField = dataReader.GetString(2);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext10.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ClientRedirectUri | Resolver: namelessParameter{89} => namelessParameter{89}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ClientRedirectUri)
                        }
                        ;
                        return instance10;
                    } : 
                    {
                        object[] keyValues10;
                        keyValues10 = new object[]{ (object)dataReader.GetInt32(0) };
                        return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                            entityType: [LIFTABLE Constant: EntityType: ClientRedirectUri | Resolver: namelessParameter{90} => namelessParameter{90}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri")], 
                            properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ClientRedirectUri.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri").FindPrimaryKey().Properties], 
                            keyValues: keyValues10);
                    };
                    return instance10;
                };
                return entity;
            }, 
            relatedDataLoaders: null, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ClientRedirectUri.Client (Client) ToPrincipal Client Inverse: RedirectUris | Resolver: namelessParameter{91} => namelessParameter{91}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ClientRedirectUri").FindNavigation("Client")], 
            fixup: (namelessParameter{92}, namelessParameter{93}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<Client, List<ClientRedirectUri>, ClientRedirectUri> | Resolver: namelessParameter{94} => namelessParameter{94}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.Client").FindNavigation("RedirectUris").GetCollectionAccessor()].Add(
                    entity: namelessParameter{92}, 
                    value: namelessParameter{93}, 
                    forMaterialization: True);
                return namelessParameter{93}.<Client>k__BackingField = namelessParameter{92};
            }, 
            trackingQuery: False) 
    }), 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:16.828 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:16.829 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:16.830 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.831 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.831 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.831 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.833 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-12-23 16:47:16.835 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.850 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.871 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.871 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.871 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.871 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.876 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.876 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.876 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.876 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.878 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.878 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.878 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.878 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.879 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.880 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.880 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.880 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.880 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.881 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.882 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.882 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.882 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.882 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.884 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.884 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.884 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.884 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.885 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.885 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.885 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.886 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.886 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.886 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.887 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.887 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.887 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.887 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.889 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.889 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.889 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.889 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.890 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:16.894 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.894 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 44ms reading results.
2025-12-23 16:47:16.895 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 22ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 18ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 16ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 14ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 12ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 11ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 9ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 7ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.896 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 5ms reading results.
2025-12-23 16:47:16.896 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.897 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:16.901 +08:00 [DBG] uc_localhost_5174 found in database: true
2025-12-23 16:47:16.905 +08:00 [DBG] client configuration validation for client uc_localhost_5174 succeeded.
2025-12-23 16:47:16.911 +08:00 [DBG] Checking for PKCE parameters
2025-12-23 16:47:16.919 +08:00 [DBG] Compiling query expression: 
'DbSet<IdentityResource>()
    .Where(identityResource => __scopes_0
        .Contains(identityResource.Name))
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:16.923 +08:00 [DBG] Including navigation: 'IdentityResource.UserClaims'.
2025-12-23 16:47:16.923 +08:00 [DBG] Including navigation: 'IdentityResource.Properties'.
2025-12-23 16:47:16.971 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<IdentityResource>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityResource.Created (DateTime) Required, 1], [Property: IdentityResource.Description (string) MaxLength(1000), 2], [Property: IdentityResource.DisplayName (string) MaxLength(200), 3], [Property: IdentityResource.Emphasize (bool) Required, 4], [Property: IdentityResource.Enabled (bool) Required, 5], [Property: IdentityResource.Name (string) Required Index MaxLength(200), 6], [Property: IdentityResource.NonEditable (bool) Required, 7], [Property: IdentityResource.Required (bool) Required, 8], [Property: IdentityResource.ShowInDiscoveryDocument (bool) Required, 9], [Property: IdentityResource.Updated (DateTime?), 10] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: IdentityResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: IdentityResourceClaim.IdentityResourceId (int) Required FK Index, 12], [Property: IdentityResourceClaim.Type (string) Required Index MaxLength(200), 13] }
            3 -> 11
            4 -> Dictionary<IProperty, int> { [Property: IdentityResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: IdentityResourceProperty.IdentityResourceId (int) Required FK Index, 15], [Property: IdentityResourceProperty.Key (string) Required Index MaxLength(250), 16], [Property: IdentityResourceProperty.Value (string) Required MaxLength(2000), 17] }
            5 -> 14
        SELECT i.Id, i.Created, i.Description, i.DisplayName, i.Emphasize, i.Enabled, i.Name, i.NonEditable, i.Required, i.ShowInDiscoveryDocument, i.Updated, i0.Id, i0.IdentityResourceId, i0.Type, i1.Id, i1.IdentityResourceId, i1.Key, i1.Value
        FROM IdentityResources AS i
        LEFT JOIN IdentityResourceClaims AS i0 ON i.Id == i0.IdentityResourceId
        LEFT JOIN IdentityResourceProperties AS i1 ON i.Id == i1.IdentityResourceId
        WHERE i.Name IN (
            SELECT s.value
            FROM OPENJSON(@__scopes_0) WITH (value nvarchar(200) '') AS s)
        ORDER BY i.Id ASC, i0.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityResource.Created (DateTime) Required, 1], [Property: IdentityResource.Description (string) MaxLength(1000), 2], [Property: IdentityResource.DisplayName (string) MaxLength(200), 3], [Property: IdentityResource.Emphasize (bool) Required, 4], [Property: IdentityResource.Enabled (bool) Required, 5], [Property: IdentityResource.Name (string) Required Index MaxLength(200), 6], [Property: IdentityResource.NonEditable (bool) Required, 7], [Property: IdentityResource.Required (bool) Required, 8], [Property: IdentityResource.ShowInDiscoveryDocument (bool) Required, 9], [Property: IdentityResource.Updated (DateTime?), 10] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: IdentityResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: IdentityResourceClaim.IdentityResourceId (int) Required FK Index, 12], [Property: IdentityResourceClaim.Type (string) Required Index MaxLength(200), 13] }
            3 -> 11
            4 -> Dictionary<IProperty, int> { [Property: IdentityResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: IdentityResourceProperty.IdentityResourceId (int) Required FK Index, 15], [Property: IdentityResourceProperty.Key (string) Required Index MaxLength(250), 16], [Property: IdentityResourceProperty.Value (string) Required MaxLength(2000), 17] }
            5 -> 14
        SELECT i.Id, i.Created, i.Description, i.DisplayName, i.Emphasize, i.Enabled, i.Name, i.NonEditable, i.Required, i.ShowInDiscoveryDocument, i.Updated, i0.Id, i0.IdentityResourceId, i0.Type, i1.Id, i1.IdentityResourceId, i1.Key, i1.Value
        FROM IdentityResources AS i
        LEFT JOIN IdentityResourceClaims AS i0 ON i.Id == i0.IdentityResourceId
        LEFT JOIN IdentityResourceProperties AS i1 ON i.Id == i1.IdentityResourceId
        WHERE i.Name IN (
            SELECT s.value
            FROM OPENJSON(@__scopes_0) WITH (value nvarchar(200) '') AS s)
        ORDER BY i.Id ASC, i0.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            IdentityResource entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                IdentityResource instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(IdentityResource);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")]: 
                            {
                                return 
                                {
                                    IdentityResource instance;
                                    instance = new IdentityResource();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<Emphasize>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<Name>k__BackingField = dataReader.GetString(6);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Required>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(IdentityResource)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<IdentityResource, IdentityResource>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (IdentityResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: IdentityResource.UserClaims (List<IdentityResourceClaim>) Collection ToDependent IdentityResourceClaim Inverse: IdentityResource | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceClaim>, IdentityResourceClaim> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<IdentityResource, IdentityResource>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (IdentityResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: IdentityResource.Properties (List<IdentityResourceProperty>) Collection ToDependent IdentityResourceProperty Inverse: IdentityResource | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceProperty>, IdentityResourceProperty> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<IdentityResource, IdentityResourceClaim>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                IdentityResourceClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    IdentityResourceClaim instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(IdentityResourceClaim);
                    dataReader.IsDBNull(11) ? default(object) : (object)dataReader.GetInt32(11) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")]: 
                                {
                                    return 
                                    {
                                        IdentityResourceClaim instance;
                                        instance = new IdentityResourceClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(11) ? default(int) : dataReader.GetInt32(11);
                                        instance.<IdentityResourceId>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(IdentityResourceClaim)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: IdentityResourceClaim.IdentityResource (IdentityResource) ToPrincipal IdentityResource Inverse: UserClaims | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim").FindNavigation("IdentityResource")], 
            fixup: (namelessParameter{12}, namelessParameter{13}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceClaim>, IdentityResourceClaim> | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{13}, 
                    forMaterialization: True);
                return namelessParameter{13}.<IdentityResource>k__BackingField = namelessParameter{12};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<IdentityResource, IdentityResourceProperty>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(14) ? default(int?) : (int?)dataReader.GetInt32(14) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                IdentityResourceProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    IdentityResourceProperty instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(IdentityResourceProperty);
                    dataReader.IsDBNull(14) ? default(object) : (object)dataReader.GetInt32(14) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")]: 
                                {
                                    return 
                                    {
                                        IdentityResourceProperty instance;
                                        instance = new IdentityResourceProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(14) ? default(int) : dataReader.GetInt32(14);
                                        instance.<IdentityResourceId>k__BackingField = dataReader.IsDBNull(15) ? default(int) : dataReader.GetInt32(15);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(IdentityResourceProperty)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: IdentityResourceProperty.IdentityResource (IdentityResource) ToPrincipal IdentityResource Inverse: Properties | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty").FindNavigation("IdentityResource")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceProperty>, IdentityResourceProperty> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{19}, 
                    value: namelessParameter{20}, 
                    forMaterialization: True);
                return namelessParameter{20}.<IdentityResource>k__BackingField = namelessParameter{19};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (IdentityResource)(resultContext.Values[0]) : default(IdentityResource);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:16.981 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.981 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:16.981 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:16.982 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:16.984 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-12-23 16:47:16.984 +08:00 [DBG] Executing DbCommand [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
WHERE [i].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:17.005 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
WHERE [i].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:17.009 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.009 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 4ms reading results.
2025-12-23 16:47:17.010 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.010 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.011 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2025-12-23 16:47:17.015 +08:00 [DBG] Compiling query expression: 
'DbSet<ApiResource>()
    .Where(api => api.Scopes
        .Any(x => __names_0
            .Contains(x.Scope)))
    .Include(x => x.Secrets)
    .Include(x => x.Scopes)
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:17.017 +08:00 [DBG] Including navigation: 'ApiResource.Secrets'.
2025-12-23 16:47:17.017 +08:00 [DBG] Including navigation: 'ApiResource.Scopes'.
2025-12-23 16:47:17.017 +08:00 [DBG] Including navigation: 'ApiResource.UserClaims'.
2025-12-23 16:47:17.017 +08:00 [DBG] Including navigation: 'ApiResource.Properties'.
2025-12-23 16:47:17.086 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApiResource>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiResource.AllowedAccessTokenSigningAlgorithms (string) MaxLength(100), 1], [Property: ApiResource.Created (DateTime) Required, 2], [Property: ApiResource.Description (string) MaxLength(1000), 3], [Property: ApiResource.DisplayName (string) MaxLength(200), 4], [Property: ApiResource.Enabled (bool) Required, 5], [Property: ApiResource.LastAccessed (DateTime?), 6], [Property: ApiResource.Name (string) Required Index MaxLength(200), 7], [Property: ApiResource.NonEditable (bool) Required, 8], [Property: ApiResource.RequireResourceIndicator (bool) Required, 9], [Property: ApiResource.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiResource.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiResourceSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiResourceSecret.ApiResourceId (int) Required FK Index, 13], [Property: ApiResourceSecret.Created (DateTime) Required, 14], [Property: ApiResourceSecret.Description (string) MaxLength(1000), 15], [Property: ApiResourceSecret.Expiration (DateTime?), 16], [Property: ApiResourceSecret.Type (string) Required MaxLength(250), 17], [Property: ApiResourceSecret.Value (string) Required MaxLength(4000), 18] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiResourceScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 19], [Property: ApiResourceScope.ApiResourceId (int) Required FK Index, 20], [Property: ApiResourceScope.Scope (string) Required Index MaxLength(200), 21] }
            5 -> 19
            6 -> Dictionary<IProperty, int> { [Property: ApiResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: ApiResourceClaim.ApiResourceId (int) Required FK Index, 23], [Property: ApiResourceClaim.Type (string) Required Index MaxLength(200), 24] }
            7 -> 22
            8 -> Dictionary<IProperty, int> { [Property: ApiResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 25], [Property: ApiResourceProperty.ApiResourceId (int) Required FK Index, 26], [Property: ApiResourceProperty.Key (string) Required Index MaxLength(250), 27], [Property: ApiResourceProperty.Value (string) Required MaxLength(2000), 28] }
            9 -> 25
        SELECT a.Id, a.AllowedAccessTokenSigningAlgorithms, a.Created, a.Description, a.DisplayName, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.RequireResourceIndicator, a.ShowInDiscoveryDocument, a.Updated, a1.Id, a1.ApiResourceId, a1.Created, a1.Description, a1.Expiration, a1.Type, a1.Value, a2.Id, a2.ApiResourceId, a2.Scope, a3.Id, a3.ApiResourceId, a3.Type, a4.Id, a4.ApiResourceId, a4.Key, a4.Value
        FROM ApiResources AS a
        LEFT JOIN ApiResourceSecrets AS a1 ON a.Id == a1.ApiResourceId
        LEFT JOIN ApiResourceScopes AS a2 ON a.Id == a2.ApiResourceId
        LEFT JOIN ApiResourceClaims AS a3 ON a.Id == a3.ApiResourceId
        LEFT JOIN ApiResourceProperties AS a4 ON a.Id == a4.ApiResourceId
        WHERE EXISTS (
            SELECT 1
            FROM ApiResourceScopes AS a0
            WHERE ((a.Id != NULL) && (a.Id == a0.ApiResourceId)) && a0.Scope IN (
                SELECT n.value
                FROM OPENJSON(@__names_0) WITH (value nvarchar(200) '') AS n))
        ORDER BY a.Id ASC, a1.Id ASC, a2.Id ASC, a3.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiResource.AllowedAccessTokenSigningAlgorithms (string) MaxLength(100), 1], [Property: ApiResource.Created (DateTime) Required, 2], [Property: ApiResource.Description (string) MaxLength(1000), 3], [Property: ApiResource.DisplayName (string) MaxLength(200), 4], [Property: ApiResource.Enabled (bool) Required, 5], [Property: ApiResource.LastAccessed (DateTime?), 6], [Property: ApiResource.Name (string) Required Index MaxLength(200), 7], [Property: ApiResource.NonEditable (bool) Required, 8], [Property: ApiResource.RequireResourceIndicator (bool) Required, 9], [Property: ApiResource.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiResource.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiResourceSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiResourceSecret.ApiResourceId (int) Required FK Index, 13], [Property: ApiResourceSecret.Created (DateTime) Required, 14], [Property: ApiResourceSecret.Description (string) MaxLength(1000), 15], [Property: ApiResourceSecret.Expiration (DateTime?), 16], [Property: ApiResourceSecret.Type (string) Required MaxLength(250), 17], [Property: ApiResourceSecret.Value (string) Required MaxLength(4000), 18] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiResourceScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 19], [Property: ApiResourceScope.ApiResourceId (int) Required FK Index, 20], [Property: ApiResourceScope.Scope (string) Required Index MaxLength(200), 21] }
            5 -> 19
            6 -> Dictionary<IProperty, int> { [Property: ApiResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: ApiResourceClaim.ApiResourceId (int) Required FK Index, 23], [Property: ApiResourceClaim.Type (string) Required Index MaxLength(200), 24] }
            7 -> 22
            8 -> Dictionary<IProperty, int> { [Property: ApiResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 25], [Property: ApiResourceProperty.ApiResourceId (int) Required FK Index, 26], [Property: ApiResourceProperty.Key (string) Required Index MaxLength(250), 27], [Property: ApiResourceProperty.Value (string) Required MaxLength(2000), 28] }
            9 -> 25
        SELECT a.Id, a.AllowedAccessTokenSigningAlgorithms, a.Created, a.Description, a.DisplayName, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.RequireResourceIndicator, a.ShowInDiscoveryDocument, a.Updated, a1.Id, a1.ApiResourceId, a1.Created, a1.Description, a1.Expiration, a1.Type, a1.Value, a2.Id, a2.ApiResourceId, a2.Scope, a3.Id, a3.ApiResourceId, a3.Type, a4.Id, a4.ApiResourceId, a4.Key, a4.Value
        FROM ApiResources AS a
        LEFT JOIN ApiResourceSecrets AS a1 ON a.Id == a1.ApiResourceId
        LEFT JOIN ApiResourceScopes AS a2 ON a.Id == a2.ApiResourceId
        LEFT JOIN ApiResourceClaims AS a3 ON a.Id == a3.ApiResourceId
        LEFT JOIN ApiResourceProperties AS a4 ON a.Id == a4.ApiResourceId
        WHERE EXISTS (
            SELECT 1
            FROM ApiResourceScopes AS a0
            WHERE ((a.Id != NULL) && (a.Id == a0.ApiResourceId)) && a0.Scope IN (
                SELECT n.value
                FROM OPENJSON(@__names_0) WITH (value nvarchar(200) '') AS n))
        ORDER BY a.Id ASC, a1.Id ASC, a2.Id ASC, a3.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            ApiResource entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                ApiResource instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(ApiResource);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")]: 
                            {
                                return 
                                {
                                    ApiResource instance;
                                    instance = new ApiResource();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<AllowedAccessTokenSigningAlgorithms>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<LastAccessed>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                    instance.<Name>k__BackingField = dataReader.GetString(7);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<RequireResourceIndicator>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(ApiResource)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Secrets (List<ApiResourceSecret>) Collection ToDependent ApiResourceSecret Inverse: ApiResource | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceSecret>, ApiResourceSecret> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Scopes (List<ApiResourceScope>) Collection ToDependent ApiResourceScope Inverse: ApiResource | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceScope>, ApiResourceScope> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 2, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                    (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.UserClaims (List<ApiResourceClaim>) Collection ToDependent ApiResourceClaim Inverse: ApiResource | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceClaim>, ApiResourceClaim> | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 3, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                    (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19), 
                    (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Properties (List<ApiResourceProperty>) Collection ToDependent ApiResourceProperty Inverse: ApiResource | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceProperty>, ApiResourceProperty> | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceSecret>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceSecret entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApiResourceSecret instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApiResourceSecret);
                    dataReader.IsDBNull(12) ? default(object) : (object)dataReader.GetInt32(12) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")]: 
                                {
                                    return 
                                    {
                                        ApiResourceSecret instance;
                                        instance = new ApiResourceSecret();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                        instance.<Created>k__BackingField = dataReader.IsDBNull(14) ? default(DateTime) : dataReader.GetDateTime(14);
                                        instance.<Description>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<Expiration>k__BackingField = dataReader.IsDBNull(16) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(16);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceSecret)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceSecret.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Secrets | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceSecret>, ApiResourceSecret> | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets").GetCollectionAccessor()].Add(
                    entity: namelessParameter{16}, 
                    value: namelessParameter{17}, 
                    forMaterialization: True);
                return namelessParameter{17}.<ApiResource>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceScope>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceScope entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    ApiResourceScope instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(ApiResourceScope);
                    dataReader.IsDBNull(19) ? default(object) : (object)dataReader.GetInt32(19) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{19} => namelessParameter{19}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{20} => namelessParameter{20}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")]: 
                                {
                                    return 
                                    {
                                        ApiResourceScope instance;
                                        instance = new ApiResourceScope();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(19) ? default(int) : dataReader.GetInt32(19);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(20) ? default(int) : dataReader.GetInt32(20);
                                        instance.<Scope>k__BackingField = dataReader.IsDBNull(21) ? default(string) : dataReader.GetString(21);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceScope)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceScope.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Scopes | Resolver: namelessParameter{22} => namelessParameter{22}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{23}, namelessParameter{24}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceScope>, ApiResourceScope> | Resolver: namelessParameter{25} => namelessParameter{25}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes").GetCollectionAccessor()].Add(
                    entity: namelessParameter{23}, 
                    value: namelessParameter{24}, 
                    forMaterialization: True);
                return namelessParameter{24}.<ApiResource>k__BackingField = namelessParameter{23};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceClaim>(
            collectionId: 2, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext4;
                    IEntityType entityType4;
                    ApiResourceClaim instance4;
                    materializationContext4 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance4 = default(ApiResourceClaim);
                    dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
                    {
                        ISnapshot shadowSnapshot4;
                        shadowSnapshot4 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType4 = [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{26} => namelessParameter{26}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")];
                        instance4 = switch (entityType4)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{27} => namelessParameter{27}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")]: 
                                {
                                    return 
                                    {
                                        ApiResourceClaim instance;
                                        instance = new ApiResourceClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(23) ? default(int) : dataReader.GetInt32(23);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext4.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{28} => namelessParameter{28}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceClaim)
                        }
                        ;
                        return instance4;
                    } : default(void);
                    return instance4;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceClaim.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: UserClaims | Resolver: namelessParameter{29} => namelessParameter{29}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{30}, namelessParameter{31}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceClaim>, ApiResourceClaim> | Resolver: namelessParameter{32} => namelessParameter{32}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{30}, 
                    value: namelessParameter{31}, 
                    forMaterialization: True);
                return namelessParameter{31}.<ApiResource>k__BackingField = namelessParameter{30};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceProperty>(
            collectionId: 3, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19), 
                (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(25) ? default(int?) : (int?)dataReader.GetInt32(25) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext5;
                    IEntityType entityType5;
                    ApiResourceProperty instance5;
                    materializationContext5 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance5 = default(ApiResourceProperty);
                    dataReader.IsDBNull(25) ? default(object) : (object)dataReader.GetInt32(25) != null ? 
                    {
                        ISnapshot shadowSnapshot5;
                        shadowSnapshot5 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType5 = [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{33} => namelessParameter{33}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")];
                        instance5 = switch (entityType5)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{34} => namelessParameter{34}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")]: 
                                {
                                    return 
                                    {
                                        ApiResourceProperty instance;
                                        instance = new ApiResourceProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(25) ? default(int) : dataReader.GetInt32(25);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(26) ? default(int) : dataReader.GetInt32(26);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(27) ? default(string) : dataReader.GetString(27);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext5.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{35} => namelessParameter{35}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceProperty)
                        }
                        ;
                        return instance5;
                    } : default(void);
                    return instance5;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceProperty.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Properties | Resolver: namelessParameter{36} => namelessParameter{36}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{37}, namelessParameter{38}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceProperty>, ApiResourceProperty> | Resolver: namelessParameter{39} => namelessParameter{39}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{37}, 
                    value: namelessParameter{38}, 
                    forMaterialization: True);
                return namelessParameter{38}.<ApiResource>k__BackingField = namelessParameter{37};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (ApiResource)(resultContext.Values[0]) : default(ApiResource);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:17.094 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.094 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.095 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:17.095 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.095 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.095 +08:00 [DBG] Executing DbCommand [Parameters=[@__names_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a1].[Id], [a1].[ApiResourceId], [a1].[Created], [a1].[Description], [a1].[Expiration], [a1].[Type], [a1].[Value], [a2].[Id], [a2].[ApiResourceId], [a2].[Scope], [a3].[Id], [a3].[ApiResourceId], [a3].[Type], [a4].[Id], [a4].[ApiResourceId], [a4].[Key], [a4].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a4] ON [a].[Id] = [a4].[ApiResourceId]
WHERE EXISTS (
    SELECT 1
    FROM [ApiResourceScopes] AS [a0]
    WHERE [a].[Id] = [a0].[ApiResourceId] AND [a0].[Scope] IN (
        SELECT [n].[value]
        FROM OPENJSON(@__names_0) WITH ([value] nvarchar(200) '$') AS [n]
    ))
ORDER BY [a].[Id], [a1].[Id], [a2].[Id], [a3].[Id]
2025-12-23 16:47:17.096 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__names_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a1].[Id], [a1].[ApiResourceId], [a1].[Created], [a1].[Description], [a1].[Expiration], [a1].[Type], [a1].[Value], [a2].[Id], [a2].[ApiResourceId], [a2].[Scope], [a3].[Id], [a3].[ApiResourceId], [a3].[Type], [a4].[Id], [a4].[ApiResourceId], [a4].[Key], [a4].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a4] ON [a].[Id] = [a4].[ApiResourceId]
WHERE EXISTS (
    SELECT 1
    FROM [ApiResourceScopes] AS [a0]
    WHERE [a].[Id] = [a0].[ApiResourceId] AND [a0].[Scope] IN (
        SELECT [n].[value]
        FROM OPENJSON(@__names_0) WITH ([value] nvarchar(200) '$') AS [n]
    ))
ORDER BY [a].[Id], [a1].[Id], [a2].[Id], [a3].[Id]
2025-12-23 16:47:17.096 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.096 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:17.096 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.096 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.097 +08:00 [DBG] Found [] API resources in database
2025-12-23 16:47:17.099 +08:00 [DBG] Compiling query expression: 
'DbSet<ApiScope>()
    .Where(scope => __scopes_0
        .Contains(scope.Name))
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:17.100 +08:00 [DBG] Including navigation: 'ApiScope.UserClaims'.
2025-12-23 16:47:17.100 +08:00 [DBG] Including navigation: 'ApiScope.Properties'.
2025-12-23 16:47:17.118 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApiScope>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiScope.Created (DateTime) Required, 1], [Property: ApiScope.Description (string) MaxLength(1000), 2], [Property: ApiScope.DisplayName (string) MaxLength(200), 3], [Property: ApiScope.Emphasize (bool) Required, 4], [Property: ApiScope.Enabled (bool) Required, 5], [Property: ApiScope.LastAccessed (DateTime?), 6], [Property: ApiScope.Name (string) Required Index MaxLength(200), 7], [Property: ApiScope.NonEditable (bool) Required, 8], [Property: ApiScope.Required (bool) Required, 9], [Property: ApiScope.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiScope.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiScopeClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiScopeClaim.ScopeId (int) Required FK Index, 13], [Property: ApiScopeClaim.Type (string) Required Index MaxLength(200), 14] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiScopeProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 15], [Property: ApiScopeProperty.Key (string) Required Index MaxLength(250), 16], [Property: ApiScopeProperty.ScopeId (int) Required FK Index, 17], [Property: ApiScopeProperty.Value (string) Required MaxLength(2000), 18] }
            5 -> 15
        SELECT a.Id, a.Created, a.Description, a.DisplayName, a.Emphasize, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.Required, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ScopeId, a0.Type, a1.Id, a1.Key, a1.ScopeId, a1.Value
        FROM ApiScopes AS a
        LEFT JOIN ApiScopeClaims AS a0 ON a.Id == a0.ScopeId
        LEFT JOIN ApiScopeProperties AS a1 ON a.Id == a1.ScopeId
        WHERE a.Name IN (
            SELECT s.value
            FROM OPENJSON(@__scopes_0) WITH (value nvarchar(200) '') AS s)
        ORDER BY a.Id ASC, a0.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiScope.Created (DateTime) Required, 1], [Property: ApiScope.Description (string) MaxLength(1000), 2], [Property: ApiScope.DisplayName (string) MaxLength(200), 3], [Property: ApiScope.Emphasize (bool) Required, 4], [Property: ApiScope.Enabled (bool) Required, 5], [Property: ApiScope.LastAccessed (DateTime?), 6], [Property: ApiScope.Name (string) Required Index MaxLength(200), 7], [Property: ApiScope.NonEditable (bool) Required, 8], [Property: ApiScope.Required (bool) Required, 9], [Property: ApiScope.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiScope.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiScopeClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiScopeClaim.ScopeId (int) Required FK Index, 13], [Property: ApiScopeClaim.Type (string) Required Index MaxLength(200), 14] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiScopeProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 15], [Property: ApiScopeProperty.Key (string) Required Index MaxLength(250), 16], [Property: ApiScopeProperty.ScopeId (int) Required FK Index, 17], [Property: ApiScopeProperty.Value (string) Required MaxLength(2000), 18] }
            5 -> 15
        SELECT a.Id, a.Created, a.Description, a.DisplayName, a.Emphasize, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.Required, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ScopeId, a0.Type, a1.Id, a1.Key, a1.ScopeId, a1.Value
        FROM ApiScopes AS a
        LEFT JOIN ApiScopeClaims AS a0 ON a.Id == a0.ScopeId
        LEFT JOIN ApiScopeProperties AS a1 ON a.Id == a1.ScopeId
        WHERE a.Name IN (
            SELECT s.value
            FROM OPENJSON(@__scopes_0) WITH (value nvarchar(200) '') AS s)
        ORDER BY a.Id ASC, a0.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            ApiScope entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                ApiScope instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(ApiScope);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")]: 
                            {
                                return 
                                {
                                    ApiScope instance;
                                    instance = new ApiScope();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<Emphasize>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<LastAccessed>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                    instance.<Name>k__BackingField = dataReader.GetString(7);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<Required>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(ApiScope)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiScope, ApiScope>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiScope)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: ApiScope.UserClaims (List<ApiScopeClaim>) Collection ToDependent ApiScopeClaim Inverse: Scope | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeClaim>, ApiScopeClaim> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiScope, ApiScope>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiScope)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiScope.Properties (List<ApiScopeProperty>) Collection ToDependent ApiScopeProperty Inverse: Scope | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeProperty>, ApiScopeProperty> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiScope, ApiScopeClaim>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiScopeClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApiScopeClaim instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApiScopeClaim);
                    dataReader.IsDBNull(12) ? default(object) : (object)dataReader.GetInt32(12) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")]: 
                                {
                                    return 
                                    {
                                        ApiScopeClaim instance;
                                        instance = new ApiScopeClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<ScopeId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiScopeClaim)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiScopeClaim.Scope (ApiScope) ToPrincipal ApiScope Inverse: UserClaims | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim").FindNavigation("Scope")], 
            fixup: (namelessParameter{12}, namelessParameter{13}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeClaim>, ApiScopeClaim> | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{13}, 
                    forMaterialization: True);
                return namelessParameter{13}.<Scope>k__BackingField = namelessParameter{12};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiScope, ApiScopeProperty>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(15) ? default(int?) : (int?)dataReader.GetInt32(15) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiScopeProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    ApiScopeProperty instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(ApiScopeProperty);
                    dataReader.IsDBNull(15) ? default(object) : (object)dataReader.GetInt32(15) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")]: 
                                {
                                    return 
                                    {
                                        ApiScopeProperty instance;
                                        instance = new ApiScopeProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(15) ? default(int) : dataReader.GetInt32(15);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<ScopeId>k__BackingField = dataReader.IsDBNull(17) ? default(int) : dataReader.GetInt32(17);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiScopeProperty)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiScopeProperty.Scope (ApiScope) ToPrincipal ApiScope Inverse: Properties | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty").FindNavigation("Scope")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeProperty>, ApiScopeProperty> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{19}, 
                    value: namelessParameter{20}, 
                    forMaterialization: True);
                return namelessParameter{20}.<Scope>k__BackingField = namelessParameter{19};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (ApiScope)(resultContext.Values[0]) : default(ApiScope);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:17.122 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.122 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.122 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:17.122 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.122 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.123 +08:00 [DBG] Executing DbCommand [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
WHERE [a].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:17.124 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
WHERE [a].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:17.124 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.124 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:17.124 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.124 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.124 +08:00 [DBG] Found [] scopes in database
2025-12-23 16:47:17.132 +08:00 [DBG] Calling into custom validator: Duende.IdentityServer.Validation.DefaultCustomAuthorizeRequestValidator
2025-12-23 16:47:17.145 +08:00 [DBG] ValidatedAuthorizeRequest
{"ClientId":"uc_localhost_5174","ClientName":"Localhost Dev (5174)","RedirectUri":"http://localhost:5174/demo?tab=uc-sso&callback=true","AllowedRedirectUris":["http://localhost:5174/auth/callback","http://localhost:5174/demo?tab=uc-sso&callback=true"],"SubjectId":"1bd29909-68f6-4442-bd5b-242240d49a47","ResponseType":"code","ResponseMode":"query","GrantType":"authorization_code","RequestedScopes":"openid profile email","State":"15ffcdc984eb460bae2382ef4f2382f5","UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":"","MaxAge":null,"LoginHint":null,"SessionId":"02A18485EDDB4BD1F6CEA3595BE0A16B","Raw":{"client_id":"uc_localhost_5174","redirect_uri":"http://localhost:5174/demo?tab=uc-sso&callback=true","response_type":"code","scope":"openid profile email","state":"15ffcdc984eb460bae2382ef4f2382f5","code_challenge":"zn2rx3ca3h5SKlcDfnWfUeDRS1AWTaxNe4MMw3_l0Qs","code_challenge_method":"S256"},"$type":"AuthorizeRequestValidationLog"}
2025-12-23 16:47:17.152 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'AdminIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:17.159 +08:00 [DBG] Compiling query expression: 
'DbSet<UserIdentity>()
    .FirstOrDefault(e => EF.Property<string>(e, "Id") == __p_0)'
2025-12-23 16:47:17.168 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<UserIdentity>(
    asyncEnumerable: SingleQueryingEnumerable.Create<UserIdentity>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: UserIdentity.Id (string) Required PK AfterSave:Throw, 0], [Property: UserIdentity.AccessFailedCount (int) Required, 1], [Property: UserIdentity.ConcurrencyStamp (string) Concurrency, 2], [Property: UserIdentity.Email (string) MaxLength(256), 3], [Property: UserIdentity.EmailConfirmed (bool) Required, 4], [Property: UserIdentity.LockoutEnabled (bool) Required, 5], [Property: UserIdentity.LockoutEnd (DateTimeOffset?), 6], [Property: UserIdentity.NormalizedEmail (string) Index MaxLength(256), 7], [Property: UserIdentity.NormalizedUserName (string) Index MaxLength(256), 8], [Property: UserIdentity.PasswordHash (string), 9], [Property: UserIdentity.PhoneNumber (string), 10], [Property: UserIdentity.PhoneNumberConfirmed (bool) Required, 11], [Property: UserIdentity.SecurityStamp (string), 12], [Property: UserIdentity.TwoFactorEnabled (bool) Required, 13], [Property: UserIdentity.UserName (string) MaxLength(256), 14] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.Email, u.EmailConfirmed, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.SecurityStamp, u.TwoFactorEnabled, u.UserName
            FROM Users AS u
            WHERE u.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: UserIdentity.Id (string) Required PK AfterSave:Throw, 0], [Property: UserIdentity.AccessFailedCount (int) Required, 1], [Property: UserIdentity.ConcurrencyStamp (string) Concurrency, 2], [Property: UserIdentity.Email (string) MaxLength(256), 3], [Property: UserIdentity.EmailConfirmed (bool) Required, 4], [Property: UserIdentity.LockoutEnabled (bool) Required, 5], [Property: UserIdentity.LockoutEnd (DateTimeOffset?), 6], [Property: UserIdentity.NormalizedEmail (string) Index MaxLength(256), 7], [Property: UserIdentity.NormalizedUserName (string) Index MaxLength(256), 8], [Property: UserIdentity.PasswordHash (string), 9], [Property: UserIdentity.PhoneNumber (string), 10], [Property: UserIdentity.PhoneNumberConfirmed (bool) Required, 11], [Property: UserIdentity.SecurityStamp (string), 12], [Property: UserIdentity.TwoFactorEnabled (bool) Required, 13], [Property: UserIdentity.UserName (string) MaxLength(256), 14] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.Email, u.EmailConfirmed, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.SecurityStamp, u.TwoFactorEnabled, u.UserName
            FROM Users AS u
            WHERE u.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            UserIdentity entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                UserIdentity instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(UserIdentity);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: UserIdentity.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentity").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetString(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (UserIdentity)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: UserIdentity | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentity")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: UserIdentity | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentity")]: 
                            {
                                return 
                                {
                                    UserIdentity instance;
                                    instance = new UserIdentity();
                                    instance.<Id>k__BackingField = dataReader.GetString(0);
                                    instance.<AccessFailedCount>k__BackingField = dataReader.GetInt32(1);
                                    instance.<ConcurrencyStamp>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<Email>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<EmailConfirmed>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<LockoutEnabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<LockoutEnd>k__BackingField = dataReader.IsDBNull(6) ? default(DateTimeOffset?) : (DateTimeOffset?)dataReader.GetFieldValue<DateTimeOffset>(6);
                                    instance.<NormalizedEmail>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<NormalizedUserName>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<PasswordHash>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<PhoneNumber>k__BackingField = dataReader.IsDBNull(10) ? default(string) : dataReader.GetString(10);
                                    instance.<PhoneNumberConfirmed>k__BackingField = dataReader.GetBoolean(11);
                                    instance.<SecurityStamp>k__BackingField = dataReader.IsDBNull(12) ? default(string) : dataReader.GetString(12);
                                    instance.<TwoFactorEnabled>k__BackingField = dataReader.GetBoolean(13);
                                    instance.<UserName>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: UserIdentity | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentity")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(UserIdentity)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.AdminIdentityDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-12-23 16:47:17.171 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:17.171 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:17.171 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.171 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.171 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:17.171 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.171 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.171 +08:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-12-23 16:47:17.172 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-12-23 16:47:17.198 +08:00 [DBG] Context 'AdminIdentityDbContext' started tracking 'UserIdentity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:17.225 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.225 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 52ms reading results.
2025-12-23 16:47:17.225 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.225 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.229 +08:00 [DBG] Client is configured to not require consent, no consent is required
2025-12-23 16:47:17.231 +08:00 [DBG] Creating Authorization Code Flow response.
2025-12-23 16:47:17.248 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerPersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:17.249 +08:00 [DBG] Compiling query expression: 
'DbSet<PersistedGrant>()
    .Where(x => x.Key == __token_Key_0)'
2025-12-23 16:47:17.254 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<PersistedGrant>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__token_Key_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__token_Key_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        PersistedGrant entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            PersistedGrant instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(PersistedGrant);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: PersistedGrant.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt64(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (PersistedGrant)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]: 
                        {
                            return 
                            {
                                PersistedGrant instance;
                                instance = new PersistedGrant();
                                instance.<Id>k__BackingField = dataReader.GetInt64(0);
                                instance.<ClientId>k__BackingField = dataReader.GetString(1);
                                instance.<ConsumedTime>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                instance.<CreationTime>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Data>k__BackingField = dataReader.GetString(4);
                                instance.<Description>k__BackingField = dataReader.IsDBNull(5) ? default(string) : dataReader.GetString(5);
                                instance.<Expiration>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                instance.<Key>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SessionId>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                instance.<SubjectId>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<Type>k__BackingField = dataReader.GetString(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(PersistedGrant)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerPersistedGrantDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:17.258 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:17.258 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:17.258 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.258 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.258 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:17.258 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.258 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.258 +08:00 [DBG] Executing DbCommand [Parameters=[@__token_Key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__token_Key_0
2025-12-23 16:47:17.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__token_Key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__token_Key_0
2025-12-23 16:47:17.260 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.260 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:17.260 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.260 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.260 +08:00 [DBG] 50906375EE8BB4FA89CF246EC1B31CFD4EE47521C9155C9E559409971855003F not found in database
2025-12-23 16:47:17.275 +08:00 [DBG] 'IdentityServerPersistedGrantDbContext' generated a temporary value for the property 'PersistedGrant.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:17.302 +08:00 [DBG] Context 'IdentityServerPersistedGrantDbContext' started tracking 'PersistedGrant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:17.304 +08:00 [DBG] SaveChanges starting for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:17.306 +08:00 [DBG] DetectChanges starting for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:17.319 +08:00 [DBG] DetectChanges completed for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:17.360 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.360 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.363 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:17.363 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.364 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:17.364 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 200), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (Size = 100), @p8='?' (Size = 200), @p9='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PersistedGrants] ([ClientId], [ConsumedTime], [CreationTime], [Data], [Description], [Expiration], [Key], [SessionId], [SubjectId], [Type])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-12-23 16:47:17.369 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 200), @p7='?' (Size = 100), @p8='?' (Size = 200), @p9='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PersistedGrants] ([ClientId], [ConsumedTime], [CreationTime], [Data], [Description], [Expiration], [Key], [SessionId], [SubjectId], [Type])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-12-23 16:47:17.377 +08:00 [DBG] The foreign key property 'PersistedGrant.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-12-23 16:47:17.380 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.380 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 11ms reading results.
2025-12-23 16:47:17.381 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.381 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:17.388 +08:00 [DBG] An entity of type 'PersistedGrant' tracked by 'IdentityServerPersistedGrantDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:17.389 +08:00 [DBG] SaveChanges completed for 'IdentityServerPersistedGrantDbContext' with 1 entities written to the database.
2025-12-23 16:47:17.399 +08:00 [INF] {"ClientId":"uc_localhost_5174","ClientName":"Localhost Dev (5174)","RedirectUri":"http://localhost:5174/demo?tab=uc-sso&callback=true","Endpoint":"Authorize","SubjectId":"1bd29909-68f6-4442-bd5b-242240d49a47","Scopes":"openid profile email","GrantType":"authorization_code","Tokens":[{"TokenType":"code","TokenValue":"****AA-1","$type":"Token"}],"Category":"Token","Name":"Token Issued Success","EventType":"Success","Id":2000,"Message":null,"ActivityId":"8000002d-0001-f400-b63f-84710c7967bb","TimeStamp":"2025-12-23T08:47:17.3951919","ProcessId":9484,"LocalIpAddress":"172.16.68.16:443","RemoteIpAddress":"172.16.8.121","$type":"TokenIssuedSuccessEvent"}
2025-12-23 16:47:17.399 +08:00 [DBG] Authorize endpoint response
{"SubjectId":"1bd29909-68f6-4442-bd5b-242240d49a47","ClientId":"uc_localhost_5174","RedirectUri":"http://localhost:5174/demo?tab=uc-sso&callback=true","State":"15ffcdc984eb460bae2382ef4f2382f5","Scope":"openid profile email","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2025-12-23 16:47:17.419 +08:00 [DBG] 'IdentityServerConfigurationDbContext' disposed.
2025-12-23 16:47:17.419 +08:00 [DBG] Connection ID "17582052951159996460" disconnecting.
2025-12-23 16:47:17.420 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.421 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:17.421 +08:00 [DBG] 'IdentityServerPersistedGrantDbContext' disposed.
2025-12-23 16:47:17.421 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.421 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:17.421 +08:00 [DBG] 'AdminIdentityDbContext' disposed.
2025-12-23 16:47:17.422 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:17.422 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:17.422 +08:00 [INF] Request finished HTTP/2 GET https://prs.uccapital.com.tw/sts/connect/authorize?client_id=uc_localhost_5174&redirect_uri=http%3A%2F%2Flocalhost%3A5174%2Fdemo%3Ftab%3Duc-sso%26callback%3Dtrue&response_type=code&scope=openid+profile+email&state=15ffcdc984eb460bae2382ef4f2382f5&code_challenge=zn2rx3ca3h5SKlcDfnWfUeDRS1AWTaxNe4MMw3_l0Qs&code_challenge_method=S256 - 302 null null 866.5164ms
2025-12-23 16:47:18.495 +08:00 [INF] Request starting HTTP/2 GET https://prs.uccapital.com.tw/sts/.well-known/openid-configuration - null null
2025-12-23 16:47:18.497 +08:00 [DBG] The request has an origin header: 'http://localhost:5174'.
2025-12-23 16:47:18.497 +08:00 [INF] CORS policy execution successful.
2025-12-23 16:47:18.498 +08:00 [DBG] The request path /.well-known/openid-configuration does not match a supported file type
2025-12-23 16:47:18.500 +08:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:5174
2025-12-23 16:47:18.552 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:18.553 +08:00 [DBG] Compiling query expression: 
'DbSet<ClientCorsOrigin>()
    .Where(o => o.Origin == __origin_0)
    .Any()'
2025-12-23 16:47:18.556 +08:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: SingleQueryingEnumerable.Create<bool>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ClientCorsOrigins AS c
                WHERE c.Origin == @__origin_0)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM ClientCorsOrigins AS c
                WHERE c.Origin == @__origin_0), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            bool? value1;
            value1 = dataReader.IsDBNull(0) ? default(bool?) : (bool?)dataReader.GetBoolean(0);
            return (bool)value1;
        }, 
        contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-12-23 16:47:18.565 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:18.565 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:18.565 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.565 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.565 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:18.565 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.565 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.566 +08:00 [DBG] Executing DbCommand [Parameters=[@__origin_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ClientCorsOrigins] AS [c]
        WHERE [c].[Origin] = @__origin_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-23 16:47:18.567 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__origin_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ClientCorsOrigins] AS [c]
        WHERE [c].[Origin] = @__origin_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-23 16:47:18.568 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.568 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 1ms reading results.
2025-12-23 16:47:18.568 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.568 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:18.569 +08:00 [DBG] Origin http://localhost:5174 is allowed: true
2025-12-23 16:47:18.569 +08:00 [DBG] CorsPolicyService allowed origin: http://localhost:5174
2025-12-23 16:47:18.570 +08:00 [DBG] The request has an origin header: 'http://localhost:5174'.
2025-12-23 16:47:18.570 +08:00 [INF] CORS policy execution successful.
2025-12-23 16:47:18.572 +08:00 [DBG] AuthenticationScheme: Identity.Application was not authenticated.
2025-12-23 16:47:18.576 +08:00 [DBG] AuthenticationScheme: Identity.Application was not authenticated.
2025-12-23 16:47:18.576 +08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2025-12-23 16:47:18.580 +08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: Duende.IdentityServer.Endpoints.DiscoveryEndpoint
2025-12-23 16:47:18.580 +08:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2025-12-23 16:47:18.581 +08:00 [DBG] Start discovery request
2025-12-23 16:47:18.588 +08:00 [DBG] Compiling query expression: 
'DbSet<IdentityResource>()
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:18.588 +08:00 [DBG] Including navigation: 'IdentityResource.UserClaims'.
2025-12-23 16:47:18.588 +08:00 [DBG] Including navigation: 'IdentityResource.Properties'.
2025-12-23 16:47:18.606 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<IdentityResource>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityResource.Created (DateTime) Required, 1], [Property: IdentityResource.Description (string) MaxLength(1000), 2], [Property: IdentityResource.DisplayName (string) MaxLength(200), 3], [Property: IdentityResource.Emphasize (bool) Required, 4], [Property: IdentityResource.Enabled (bool) Required, 5], [Property: IdentityResource.Name (string) Required Index MaxLength(200), 6], [Property: IdentityResource.NonEditable (bool) Required, 7], [Property: IdentityResource.Required (bool) Required, 8], [Property: IdentityResource.ShowInDiscoveryDocument (bool) Required, 9], [Property: IdentityResource.Updated (DateTime?), 10] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: IdentityResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: IdentityResourceClaim.IdentityResourceId (int) Required FK Index, 12], [Property: IdentityResourceClaim.Type (string) Required Index MaxLength(200), 13] }
            3 -> 11
            4 -> Dictionary<IProperty, int> { [Property: IdentityResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: IdentityResourceProperty.IdentityResourceId (int) Required FK Index, 15], [Property: IdentityResourceProperty.Key (string) Required Index MaxLength(250), 16], [Property: IdentityResourceProperty.Value (string) Required MaxLength(2000), 17] }
            5 -> 14
        SELECT i.Id, i.Created, i.Description, i.DisplayName, i.Emphasize, i.Enabled, i.Name, i.NonEditable, i.Required, i.ShowInDiscoveryDocument, i.Updated, i0.Id, i0.IdentityResourceId, i0.Type, i1.Id, i1.IdentityResourceId, i1.Key, i1.Value
        FROM IdentityResources AS i
        LEFT JOIN IdentityResourceClaims AS i0 ON i.Id == i0.IdentityResourceId
        LEFT JOIN IdentityResourceProperties AS i1 ON i.Id == i1.IdentityResourceId
        ORDER BY i.Id ASC, i0.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityResource.Created (DateTime) Required, 1], [Property: IdentityResource.Description (string) MaxLength(1000), 2], [Property: IdentityResource.DisplayName (string) MaxLength(200), 3], [Property: IdentityResource.Emphasize (bool) Required, 4], [Property: IdentityResource.Enabled (bool) Required, 5], [Property: IdentityResource.Name (string) Required Index MaxLength(200), 6], [Property: IdentityResource.NonEditable (bool) Required, 7], [Property: IdentityResource.Required (bool) Required, 8], [Property: IdentityResource.ShowInDiscoveryDocument (bool) Required, 9], [Property: IdentityResource.Updated (DateTime?), 10] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: IdentityResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 11], [Property: IdentityResourceClaim.IdentityResourceId (int) Required FK Index, 12], [Property: IdentityResourceClaim.Type (string) Required Index MaxLength(200), 13] }
            3 -> 11
            4 -> Dictionary<IProperty, int> { [Property: IdentityResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: IdentityResourceProperty.IdentityResourceId (int) Required FK Index, 15], [Property: IdentityResourceProperty.Key (string) Required Index MaxLength(250), 16], [Property: IdentityResourceProperty.Value (string) Required MaxLength(2000), 17] }
            5 -> 14
        SELECT i.Id, i.Created, i.Description, i.DisplayName, i.Emphasize, i.Enabled, i.Name, i.NonEditable, i.Required, i.ShowInDiscoveryDocument, i.Updated, i0.Id, i0.IdentityResourceId, i0.Type, i1.Id, i1.IdentityResourceId, i1.Key, i1.Value
        FROM IdentityResources AS i
        LEFT JOIN IdentityResourceClaims AS i0 ON i.Id == i0.IdentityResourceId
        LEFT JOIN IdentityResourceProperties AS i1 ON i.Id == i1.IdentityResourceId
        ORDER BY i.Id ASC, i0.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            IdentityResource entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                IdentityResource instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(IdentityResource);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")]: 
                            {
                                return 
                                {
                                    IdentityResource instance;
                                    instance = new IdentityResource();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<Emphasize>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<Name>k__BackingField = dataReader.GetString(6);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(7);
                                    instance.<Required>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(10) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(10);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(IdentityResource)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: IdentityResource | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: IdentityResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<IdentityResource, IdentityResource>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (IdentityResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: IdentityResource.UserClaims (List<IdentityResourceClaim>) Collection ToDependent IdentityResourceClaim Inverse: IdentityResource | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceClaim>, IdentityResourceClaim> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<IdentityResource, IdentityResource>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (IdentityResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: IdentityResource.Properties (List<IdentityResourceProperty>) Collection ToDependent IdentityResourceProperty Inverse: IdentityResource | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceProperty>, IdentityResourceProperty> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<IdentityResource, IdentityResourceClaim>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                IdentityResourceClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    IdentityResourceClaim instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(IdentityResourceClaim);
                    dataReader.IsDBNull(11) ? default(object) : (object)dataReader.GetInt32(11) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")]: 
                                {
                                    return 
                                    {
                                        IdentityResourceClaim instance;
                                        instance = new IdentityResourceClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(11) ? default(int) : dataReader.GetInt32(11);
                                        instance.<IdentityResourceId>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(13) ? default(string) : dataReader.GetString(13);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: IdentityResourceClaim | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(IdentityResourceClaim)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: IdentityResourceClaim.IdentityResource (IdentityResource) ToPrincipal IdentityResource Inverse: UserClaims | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceClaim").FindNavigation("IdentityResource")], 
            fixup: (namelessParameter{12}, namelessParameter{13}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceClaim>, IdentityResourceClaim> | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{13}, 
                    forMaterialization: True);
                return namelessParameter{13}.<IdentityResource>k__BackingField = namelessParameter{12};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<IdentityResource, IdentityResourceProperty>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(11) ? default(int?) : (int?)dataReader.GetInt32(11) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(14) ? default(int?) : (int?)dataReader.GetInt32(14) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                IdentityResourceProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    IdentityResourceProperty instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(IdentityResourceProperty);
                    dataReader.IsDBNull(14) ? default(object) : (object)dataReader.GetInt32(14) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")]: 
                                {
                                    return 
                                    {
                                        IdentityResourceProperty instance;
                                        instance = new IdentityResourceProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(14) ? default(int) : dataReader.GetInt32(14);
                                        instance.<IdentityResourceId>k__BackingField = dataReader.IsDBNull(15) ? default(int) : dataReader.GetInt32(15);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: IdentityResourceProperty | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(IdentityResourceProperty)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: IdentityResourceProperty.IdentityResource (IdentityResource) ToPrincipal IdentityResource Inverse: Properties | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResourceProperty").FindNavigation("IdentityResource")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<IdentityResource, List<IdentityResourceProperty>, IdentityResourceProperty> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.IdentityResource").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{19}, 
                    value: namelessParameter{20}, 
                    forMaterialization: True);
                return namelessParameter{20}.<IdentityResource>k__BackingField = namelessParameter{19};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (IdentityResource)(resultContext.Values[0]) : default(IdentityResource);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:18.609 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.609 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.610 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:18.610 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.610 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.610 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:18.611 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:18.613 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.613 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 2ms reading results.
2025-12-23 16:47:18.613 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.613 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:18.614 +08:00 [DBG] Compiling query expression: 
'DbSet<ApiResource>()
    .Include(x => x.Secrets)
    .Include(x => x.Scopes)
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:18.615 +08:00 [DBG] Including navigation: 'ApiResource.Secrets'.
2025-12-23 16:47:18.615 +08:00 [DBG] Including navigation: 'ApiResource.Scopes'.
2025-12-23 16:47:18.615 +08:00 [DBG] Including navigation: 'ApiResource.UserClaims'.
2025-12-23 16:47:18.615 +08:00 [DBG] Including navigation: 'ApiResource.Properties'.
2025-12-23 16:47:18.647 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApiResource>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiResource.AllowedAccessTokenSigningAlgorithms (string) MaxLength(100), 1], [Property: ApiResource.Created (DateTime) Required, 2], [Property: ApiResource.Description (string) MaxLength(1000), 3], [Property: ApiResource.DisplayName (string) MaxLength(200), 4], [Property: ApiResource.Enabled (bool) Required, 5], [Property: ApiResource.LastAccessed (DateTime?), 6], [Property: ApiResource.Name (string) Required Index MaxLength(200), 7], [Property: ApiResource.NonEditable (bool) Required, 8], [Property: ApiResource.RequireResourceIndicator (bool) Required, 9], [Property: ApiResource.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiResource.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiResourceSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiResourceSecret.ApiResourceId (int) Required FK Index, 13], [Property: ApiResourceSecret.Created (DateTime) Required, 14], [Property: ApiResourceSecret.Description (string) MaxLength(1000), 15], [Property: ApiResourceSecret.Expiration (DateTime?), 16], [Property: ApiResourceSecret.Type (string) Required MaxLength(250), 17], [Property: ApiResourceSecret.Value (string) Required MaxLength(4000), 18] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiResourceScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 19], [Property: ApiResourceScope.ApiResourceId (int) Required FK Index, 20], [Property: ApiResourceScope.Scope (string) Required Index MaxLength(200), 21] }
            5 -> 19
            6 -> Dictionary<IProperty, int> { [Property: ApiResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: ApiResourceClaim.ApiResourceId (int) Required FK Index, 23], [Property: ApiResourceClaim.Type (string) Required Index MaxLength(200), 24] }
            7 -> 22
            8 -> Dictionary<IProperty, int> { [Property: ApiResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 25], [Property: ApiResourceProperty.ApiResourceId (int) Required FK Index, 26], [Property: ApiResourceProperty.Key (string) Required Index MaxLength(250), 27], [Property: ApiResourceProperty.Value (string) Required MaxLength(2000), 28] }
            9 -> 25
        SELECT a.Id, a.AllowedAccessTokenSigningAlgorithms, a.Created, a.Description, a.DisplayName, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.RequireResourceIndicator, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ApiResourceId, a0.Created, a0.Description, a0.Expiration, a0.Type, a0.Value, a1.Id, a1.ApiResourceId, a1.Scope, a2.Id, a2.ApiResourceId, a2.Type, a3.Id, a3.ApiResourceId, a3.Key, a3.Value
        FROM ApiResources AS a
        LEFT JOIN ApiResourceSecrets AS a0 ON a.Id == a0.ApiResourceId
        LEFT JOIN ApiResourceScopes AS a1 ON a.Id == a1.ApiResourceId
        LEFT JOIN ApiResourceClaims AS a2 ON a.Id == a2.ApiResourceId
        LEFT JOIN ApiResourceProperties AS a3 ON a.Id == a3.ApiResourceId
        ORDER BY a.Id ASC, a0.Id ASC, a1.Id ASC, a2.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiResource.AllowedAccessTokenSigningAlgorithms (string) MaxLength(100), 1], [Property: ApiResource.Created (DateTime) Required, 2], [Property: ApiResource.Description (string) MaxLength(1000), 3], [Property: ApiResource.DisplayName (string) MaxLength(200), 4], [Property: ApiResource.Enabled (bool) Required, 5], [Property: ApiResource.LastAccessed (DateTime?), 6], [Property: ApiResource.Name (string) Required Index MaxLength(200), 7], [Property: ApiResource.NonEditable (bool) Required, 8], [Property: ApiResource.RequireResourceIndicator (bool) Required, 9], [Property: ApiResource.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiResource.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiResourceSecret.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiResourceSecret.ApiResourceId (int) Required FK Index, 13], [Property: ApiResourceSecret.Created (DateTime) Required, 14], [Property: ApiResourceSecret.Description (string) MaxLength(1000), 15], [Property: ApiResourceSecret.Expiration (DateTime?), 16], [Property: ApiResourceSecret.Type (string) Required MaxLength(250), 17], [Property: ApiResourceSecret.Value (string) Required MaxLength(4000), 18] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiResourceScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 19], [Property: ApiResourceScope.ApiResourceId (int) Required FK Index, 20], [Property: ApiResourceScope.Scope (string) Required Index MaxLength(200), 21] }
            5 -> 19
            6 -> Dictionary<IProperty, int> { [Property: ApiResourceClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: ApiResourceClaim.ApiResourceId (int) Required FK Index, 23], [Property: ApiResourceClaim.Type (string) Required Index MaxLength(200), 24] }
            7 -> 22
            8 -> Dictionary<IProperty, int> { [Property: ApiResourceProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 25], [Property: ApiResourceProperty.ApiResourceId (int) Required FK Index, 26], [Property: ApiResourceProperty.Key (string) Required Index MaxLength(250), 27], [Property: ApiResourceProperty.Value (string) Required MaxLength(2000), 28] }
            9 -> 25
        SELECT a.Id, a.AllowedAccessTokenSigningAlgorithms, a.Created, a.Description, a.DisplayName, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.RequireResourceIndicator, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ApiResourceId, a0.Created, a0.Description, a0.Expiration, a0.Type, a0.Value, a1.Id, a1.ApiResourceId, a1.Scope, a2.Id, a2.ApiResourceId, a2.Type, a3.Id, a3.ApiResourceId, a3.Key, a3.Value
        FROM ApiResources AS a
        LEFT JOIN ApiResourceSecrets AS a0 ON a.Id == a0.ApiResourceId
        LEFT JOIN ApiResourceScopes AS a1 ON a.Id == a1.ApiResourceId
        LEFT JOIN ApiResourceClaims AS a2 ON a.Id == a2.ApiResourceId
        LEFT JOIN ApiResourceProperties AS a3 ON a.Id == a3.ApiResourceId
        ORDER BY a.Id ASC, a0.Id ASC, a1.Id ASC, a2.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            ApiResource entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                ApiResource instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(ApiResource);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")]: 
                            {
                                return 
                                {
                                    ApiResource instance;
                                    instance = new ApiResource();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<AllowedAccessTokenSigningAlgorithms>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<LastAccessed>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                    instance.<Name>k__BackingField = dataReader.GetString(7);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<RequireResourceIndicator>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(ApiResource)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: ApiResource | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ApiResource.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Secrets (List<ApiResourceSecret>) Collection ToDependent ApiResourceSecret Inverse: ApiResource | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceSecret>, ApiResourceSecret> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Scopes (List<ApiResourceScope>) Collection ToDependent ApiResourceScope Inverse: ApiResource | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceScope>, ApiResourceScope> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 2, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                    (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.UserClaims (List<ApiResourceClaim>) Collection ToDependent ApiResourceClaim Inverse: ApiResource | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceClaim>, ApiResourceClaim> | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiResource, ApiResource>(
                collectionId: 3, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiResource)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                    (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19), 
                    (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiResource.Properties (List<ApiResourceProperty>) Collection ToDependent ApiResourceProperty Inverse: ApiResource | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceProperty>, ApiResourceProperty> | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceSecret>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceSecret entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApiResourceSecret instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApiResourceSecret);
                    dataReader.IsDBNull(12) ? default(object) : (object)dataReader.GetInt32(12) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")]: 
                                {
                                    return 
                                    {
                                        ApiResourceSecret instance;
                                        instance = new ApiResourceSecret();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                        instance.<Created>k__BackingField = dataReader.IsDBNull(14) ? default(DateTime) : dataReader.GetDateTime(14);
                                        instance.<Description>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                        instance.<Expiration>k__BackingField = dataReader.IsDBNull(16) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(16);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceSecret | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceSecret)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceSecret.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Secrets | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceSecret").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{16}, namelessParameter{17}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceSecret>, ApiResourceSecret> | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Secrets").GetCollectionAccessor()].Add(
                    entity: namelessParameter{16}, 
                    value: namelessParameter{17}, 
                    forMaterialization: True);
                return namelessParameter{17}.<ApiResource>k__BackingField = namelessParameter{16};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceScope>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceScope entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    ApiResourceScope instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(ApiResourceScope);
                    dataReader.IsDBNull(19) ? default(object) : (object)dataReader.GetInt32(19) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{19} => namelessParameter{19}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{20} => namelessParameter{20}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")]: 
                                {
                                    return 
                                    {
                                        ApiResourceScope instance;
                                        instance = new ApiResourceScope();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(19) ? default(int) : dataReader.GetInt32(19);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(20) ? default(int) : dataReader.GetInt32(20);
                                        instance.<Scope>k__BackingField = dataReader.IsDBNull(21) ? default(string) : dataReader.GetString(21);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceScope | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceScope)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceScope.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Scopes | Resolver: namelessParameter{22} => namelessParameter{22}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceScope").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{23}, namelessParameter{24}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceScope>, ApiResourceScope> | Resolver: namelessParameter{25} => namelessParameter{25}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Scopes").GetCollectionAccessor()].Add(
                    entity: namelessParameter{23}, 
                    value: namelessParameter{24}, 
                    forMaterialization: True);
                return namelessParameter{24}.<ApiResource>k__BackingField = namelessParameter{23};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceClaim>(
            collectionId: 2, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext4;
                    IEntityType entityType4;
                    ApiResourceClaim instance4;
                    materializationContext4 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance4 = default(ApiResourceClaim);
                    dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
                    {
                        ISnapshot shadowSnapshot4;
                        shadowSnapshot4 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType4 = [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{26} => namelessParameter{26}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")];
                        instance4 = switch (entityType4)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{27} => namelessParameter{27}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")]: 
                                {
                                    return 
                                    {
                                        ApiResourceClaim instance;
                                        instance = new ApiResourceClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(23) ? default(int) : dataReader.GetInt32(23);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext4.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceClaim | Resolver: namelessParameter{28} => namelessParameter{28}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceClaim)
                        }
                        ;
                        return instance4;
                    } : default(void);
                    return instance4;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceClaim.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: UserClaims | Resolver: namelessParameter{29} => namelessParameter{29}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceClaim").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{30}, namelessParameter{31}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceClaim>, ApiResourceClaim> | Resolver: namelessParameter{32} => namelessParameter{32}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{30}, 
                    value: namelessParameter{31}, 
                    forMaterialization: True);
                return namelessParameter{31}.<ApiResource>k__BackingField = namelessParameter{30};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiResource, ApiResourceProperty>(
            collectionId: 3, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12), 
                (object)dataReader.IsDBNull(19) ? default(int?) : (int?)dataReader.GetInt32(19), 
                (object)dataReader.IsDBNull(22) ? default(int?) : (int?)dataReader.GetInt32(22) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(25) ? default(int?) : (int?)dataReader.GetInt32(25) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiResourceProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext5;
                    IEntityType entityType5;
                    ApiResourceProperty instance5;
                    materializationContext5 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance5 = default(ApiResourceProperty);
                    dataReader.IsDBNull(25) ? default(object) : (object)dataReader.GetInt32(25) != null ? 
                    {
                        ISnapshot shadowSnapshot5;
                        shadowSnapshot5 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType5 = [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{33} => namelessParameter{33}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")];
                        instance5 = switch (entityType5)
                        {
                            case [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{34} => namelessParameter{34}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")]: 
                                {
                                    return 
                                    {
                                        ApiResourceProperty instance;
                                        instance = new ApiResourceProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(25) ? default(int) : dataReader.GetInt32(25);
                                        instance.<ApiResourceId>k__BackingField = dataReader.IsDBNull(26) ? default(int) : dataReader.GetInt32(26);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(27) ? default(string) : dataReader.GetString(27);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext5.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiResourceProperty | Resolver: namelessParameter{35} => namelessParameter{35}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiResourceProperty)
                        }
                        ;
                        return instance5;
                    } : default(void);
                    return instance5;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiResourceProperty.ApiResource (ApiResource) ToPrincipal ApiResource Inverse: Properties | Resolver: namelessParameter{36} => namelessParameter{36}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResourceProperty").FindNavigation("ApiResource")], 
            fixup: (namelessParameter{37}, namelessParameter{38}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiResource, List<ApiResourceProperty>, ApiResourceProperty> | Resolver: namelessParameter{39} => namelessParameter{39}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiResource").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{37}, 
                    value: namelessParameter{38}, 
                    forMaterialization: True);
                return namelessParameter{38}.<ApiResource>k__BackingField = namelessParameter{37};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (ApiResource)(resultContext.Values[0]) : default(ApiResource);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:18.653 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.653 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.653 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:18.653 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.653 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.653 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ApiResourceId], [a0].[Created], [a0].[Description], [a0].[Expiration], [a0].[Type], [a0].[Value], [a1].[Id], [a1].[ApiResourceId], [a1].[Scope], [a2].[Id], [a2].[ApiResourceId], [a2].[Type], [a3].[Id], [a3].[ApiResourceId], [a3].[Key], [a3].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a0] ON [a].[Id] = [a0].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
ORDER BY [a].[Id], [a0].[Id], [a1].[Id], [a2].[Id]
2025-12-23 16:47:18.654 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ApiResourceId], [a0].[Created], [a0].[Description], [a0].[Expiration], [a0].[Type], [a0].[Value], [a1].[Id], [a1].[ApiResourceId], [a1].[Scope], [a2].[Id], [a2].[ApiResourceId], [a2].[Type], [a3].[Id], [a3].[ApiResourceId], [a3].[Key], [a3].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a0] ON [a].[Id] = [a0].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
ORDER BY [a].[Id], [a0].[Id], [a1].[Id], [a2].[Id]
2025-12-23 16:47:18.657 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.657 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 3ms reading results.
2025-12-23 16:47:18.658 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.658 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:18.658 +08:00 [DBG] Compiling query expression: 
'DbSet<ApiScope>()
    .Include(x => x.UserClaims)
    .Include(x => x.Properties)
    .AsNoTracking()'
2025-12-23 16:47:18.658 +08:00 [DBG] Including navigation: 'ApiScope.UserClaims'.
2025-12-23 16:47:18.658 +08:00 [DBG] Including navigation: 'ApiScope.Properties'.
2025-12-23 16:47:18.675 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<ApiScope>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiScope.Created (DateTime) Required, 1], [Property: ApiScope.Description (string) MaxLength(1000), 2], [Property: ApiScope.DisplayName (string) MaxLength(200), 3], [Property: ApiScope.Emphasize (bool) Required, 4], [Property: ApiScope.Enabled (bool) Required, 5], [Property: ApiScope.LastAccessed (DateTime?), 6], [Property: ApiScope.Name (string) Required Index MaxLength(200), 7], [Property: ApiScope.NonEditable (bool) Required, 8], [Property: ApiScope.Required (bool) Required, 9], [Property: ApiScope.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiScope.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiScopeClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiScopeClaim.ScopeId (int) Required FK Index, 13], [Property: ApiScopeClaim.Type (string) Required Index MaxLength(200), 14] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiScopeProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 15], [Property: ApiScopeProperty.Key (string) Required Index MaxLength(250), 16], [Property: ApiScopeProperty.ScopeId (int) Required FK Index, 17], [Property: ApiScopeProperty.Value (string) Required MaxLength(2000), 18] }
            5 -> 15
        SELECT a.Id, a.Created, a.Description, a.DisplayName, a.Emphasize, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.Required, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ScopeId, a0.Type, a1.Id, a1.Key, a1.ScopeId, a1.Value
        FROM ApiScopes AS a
        LEFT JOIN ApiScopeClaims AS a0 ON a.Id == a0.ScopeId
        LEFT JOIN ApiScopeProperties AS a1 ON a.Id == a1.ScopeId
        ORDER BY a.Id ASC, a0.Id ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: ApiScope.Created (DateTime) Required, 1], [Property: ApiScope.Description (string) MaxLength(1000), 2], [Property: ApiScope.DisplayName (string) MaxLength(200), 3], [Property: ApiScope.Emphasize (bool) Required, 4], [Property: ApiScope.Enabled (bool) Required, 5], [Property: ApiScope.LastAccessed (DateTime?), 6], [Property: ApiScope.Name (string) Required Index MaxLength(200), 7], [Property: ApiScope.NonEditable (bool) Required, 8], [Property: ApiScope.Required (bool) Required, 9], [Property: ApiScope.ShowInDiscoveryDocument (bool) Required, 10], [Property: ApiScope.Updated (DateTime?), 11] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: ApiScopeClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: ApiScopeClaim.ScopeId (int) Required FK Index, 13], [Property: ApiScopeClaim.Type (string) Required Index MaxLength(200), 14] }
            3 -> 12
            4 -> Dictionary<IProperty, int> { [Property: ApiScopeProperty.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 15], [Property: ApiScopeProperty.Key (string) Required Index MaxLength(250), 16], [Property: ApiScopeProperty.ScopeId (int) Required FK Index, 17], [Property: ApiScopeProperty.Value (string) Required MaxLength(2000), 18] }
            5 -> 15
        SELECT a.Id, a.Created, a.Description, a.DisplayName, a.Emphasize, a.Enabled, a.LastAccessed, a.Name, a.NonEditable, a.Required, a.ShowInDiscoveryDocument, a.Updated, a0.Id, a0.ScopeId, a0.Type, a1.Id, a1.Key, a1.ScopeId, a1.Value
        FROM ApiScopes AS a
        LEFT JOIN ApiScopeClaims AS a0 ON a.Id == a0.ScopeId
        LEFT JOIN ApiScopeProperties AS a1 ON a.Id == a1.ScopeId
        ORDER BY a.Id ASC, a0.Id ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        resultContext.Values == null ? 
        {
            ApiScope entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                ApiScope instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(ApiScope);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")]: 
                            {
                                return 
                                {
                                    ApiScope instance;
                                    instance = new ApiScope();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Created>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<Description>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<DisplayName>k__BackingField = dataReader.IsDBNull(3) ? default(string) : dataReader.GetString(3);
                                    instance.<Emphasize>k__BackingField = dataReader.GetBoolean(4);
                                    instance.<Enabled>k__BackingField = dataReader.GetBoolean(5);
                                    instance.<LastAccessed>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                    instance.<Name>k__BackingField = dataReader.GetString(7);
                                    instance.<NonEditable>k__BackingField = dataReader.GetBoolean(8);
                                    instance.<Required>k__BackingField = dataReader.GetBoolean(9);
                                    instance.<ShowInDiscoveryDocument>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Updated>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(ApiScope)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: ApiScope | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: ApiScope.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            resultContext.Values = new object[]{ entity };
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiScope, ApiScope>(
                collectionId: 0, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiScope)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                navigation: [LIFTABLE Constant: Navigation: ApiScope.UserClaims (List<ApiScopeClaim>) Collection ToDependent ApiScopeClaim Inverse: Scope | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeClaim>, ApiScopeClaim> | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
            ShaperProcessingExpressionVisitor.InitializeIncludeCollection<ApiScope, ApiScope>(
                collectionId: 1, 
                queryContext: queryContext, 
                dbDataReader: dataReader, 
                resultCoordinator: resultCoordinator, 
                entity: (ApiScope)(resultContext.Values[0]), 
                parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
                outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
                { 
                    (object)(int?)dataReader.GetInt32(0), 
                    (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
                }], 
                navigation: [LIFTABLE Constant: Navigation: ApiScope.Properties (List<ApiScopeProperty>) Collection ToDependent ApiScopeProperty Inverse: Scope | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties")], 
                clrCollectionAccessor: [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeProperty>, ApiScopeProperty> | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties").GetCollectionAccessor()], 
                trackingQuery: False, 
                setLoaded: True);
        } : default(void);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiScope, ApiScopeClaim>(
            collectionId: 0, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiScopeClaim entity;
                entity = 
                {
                    MaterializationContext materializationContext2;
                    IEntityType entityType2;
                    ApiScopeClaim instance2;
                    materializationContext2 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance2 = default(ApiScopeClaim);
                    dataReader.IsDBNull(12) ? default(object) : (object)dataReader.GetInt32(12) != null ? 
                    {
                        ISnapshot shadowSnapshot2;
                        shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType2 = [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")];
                        instance2 = switch (entityType2)
                        {
                            case [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")]: 
                                {
                                    return 
                                    {
                                        ApiScopeClaim instance;
                                        instance = new ApiScopeClaim();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(12) ? default(int) : dataReader.GetInt32(12);
                                        instance.<ScopeId>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                        instance.<Type>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext2.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiScopeClaim | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiScopeClaim)
                        }
                        ;
                        return instance2;
                    } : default(void);
                    return instance2;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiScopeClaim.Scope (ApiScope) ToPrincipal ApiScope Inverse: UserClaims | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeClaim").FindNavigation("Scope")], 
            fixup: (namelessParameter{12}, namelessParameter{13}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeClaim>, ApiScopeClaim> | Resolver: namelessParameter{14} => namelessParameter{14}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("UserClaims").GetCollectionAccessor()].Add(
                    entity: namelessParameter{12}, 
                    value: namelessParameter{13}, 
                    forMaterialization: True);
                return namelessParameter{13}.<Scope>k__BackingField = namelessParameter{12};
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.PopulateIncludeCollection<ApiScope, ApiScopeProperty>(
            collectionId: 1, 
            queryContext: queryContext, 
            dbDataReader: dataReader, 
            resultCoordinator: resultCoordinator, 
            parentIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)(int?)dataReader.GetInt32(0) }], 
            outerIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]
            { 
                (object)(int?)dataReader.GetInt32(0), 
                (object)dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12) 
            }], 
            selfIdentifier: [LIFTABLE Constant: Func<QueryContext, DbDataReader, object[]> | Resolver: _ => (queryContext, dataReader) => new object[]{ (object)dataReader.IsDBNull(15) ? default(int?) : (int?)dataReader.GetInt32(15) }], 
            parentIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            outerIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
            { 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
                (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
            }], 
            selfIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]{ (left, right) => left == null ? right == null : right != null && (int)left == (int)right }], 
            innerShaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
            {
                ApiScopeProperty entity;
                entity = 
                {
                    MaterializationContext materializationContext3;
                    IEntityType entityType3;
                    ApiScopeProperty instance3;
                    materializationContext3 = new MaterializationContext(
                        [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                        queryContext.Context
                    );
                    instance3 = default(ApiScopeProperty);
                    dataReader.IsDBNull(15) ? default(object) : (object)dataReader.GetInt32(15) != null ? 
                    {
                        ISnapshot shadowSnapshot3;
                        shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                        entityType3 = [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{15} => namelessParameter{15}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")];
                        instance3 = switch (entityType3)
                        {
                            case [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")]: 
                                {
                                    return 
                                    {
                                        ApiScopeProperty instance;
                                        instance = new ApiScopeProperty();
                                        instance.<Id>k__BackingField = dataReader.IsDBNull(15) ? default(int) : dataReader.GetInt32(15);
                                        instance.<Key>k__BackingField = dataReader.IsDBNull(16) ? default(string) : dataReader.GetString(16);
                                        instance.<ScopeId>k__BackingField = dataReader.IsDBNull(17) ? default(int) : dataReader.GetInt32(17);
                                        instance.<Value>k__BackingField = dataReader.IsDBNull(18) ? default(string) : dataReader.GetString(18);
                                        (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                            context: materializationContext3.Context, 
                                            entity: instance, 
                                            queryTrackingBehavior: NoTracking, 
                                            structuralType: [LIFTABLE Constant: EntityType: ApiScopeProperty | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty")]) : default(void);
                                        return instance;
                                    }}
                            default: 
                                default(ApiScopeProperty)
                        }
                        ;
                        return instance3;
                    } : default(void);
                    return instance3;
                };
                return entity;
            }, 
            inverseNavigation: [LIFTABLE Constant: Navigation: ApiScopeProperty.Scope (ApiScope) ToPrincipal ApiScope Inverse: Properties | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScopeProperty").FindNavigation("Scope")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                [LIFTABLE Constant: ClrICollectionAccessor<ApiScope, List<ApiScopeProperty>, ApiScopeProperty> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.ApiScope").FindNavigation("Properties").GetCollectionAccessor()].Add(
                    entity: namelessParameter{19}, 
                    value: namelessParameter{20}, 
                    forMaterialization: True);
                return namelessParameter{20}.<Scope>k__BackingField = namelessParameter{19};
            }, 
            trackingQuery: False);
        return IsTrue(resultCoordinator.ResultReady)
         ? (ApiScope)(resultContext.Values[0]) : default(ApiScope);
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerConfigurationDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:18.678 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.678 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.678 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:18.678 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.678 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:18.678 +08:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:18.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:18.681 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.681 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 1ms reading results.
2025-12-23 16:47:18.681 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.681 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:18.684 +08:00 [DBG] Found ["roles","openid","profile","email","address","uc_capital_admin_api"] as all scopes, and ["uc_capital_admin_api"] as API resources
2025-12-23 16:47:18.703 +08:00 [DBG] 'IdentityServerConfigurationDbContext' disposed.
2025-12-23 16:47:18.703 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:18.703 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:18.703 +08:00 [INF] Request finished HTTP/2 GET https://prs.uccapital.com.tw/sts/.well-known/openid-configuration - 200 null application/json; charset=UTF-8 207.9484ms
2025-12-23 16:47:19.030 +08:00 [INF] Request starting HTTP/2 POST https://prs.uccapital.com.tw/sts/connect/token - application/x-www-form-urlencoded 323
2025-12-23 16:47:19.031 +08:00 [DBG] The request has an origin header: 'http://localhost:5174'.
2025-12-23 16:47:19.031 +08:00 [INF] CORS policy execution successful.
2025-12-23 16:47:19.031 +08:00 [DBG] POST requests are not supported
2025-12-23 16:47:19.031 +08:00 [DBG] CORS request made for path: /connect/token from origin: http://localhost:5174
2025-12-23 16:47:19.033 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerConfigurationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:19.036 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:19.036 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:19.036 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.036 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.036 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.037 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.037 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.037 +08:00 [DBG] Executing DbCommand [Parameters=[@__origin_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ClientCorsOrigins] AS [c]
        WHERE [c].[Origin] = @__origin_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-23 16:47:19.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [ClientCorsOrigins] AS [c]
        WHERE [c].[Origin] = @__origin_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-23 16:47:19.038 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.038 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.038 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.038 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.038 +08:00 [DBG] Origin http://localhost:5174 is allowed: true
2025-12-23 16:47:19.038 +08:00 [DBG] CorsPolicyService allowed origin: http://localhost:5174
2025-12-23 16:47:19.038 +08:00 [DBG] The request has an origin header: 'http://localhost:5174'.
2025-12-23 16:47:19.038 +08:00 [INF] CORS policy execution successful.
2025-12-23 16:47:19.042 +08:00 [DBG] AuthenticationScheme: Identity.Application was not authenticated.
2025-12-23 16:47:19.047 +08:00 [DBG] AuthenticationScheme: Identity.Application was not authenticated.
2025-12-23 16:47:19.047 +08:00 [DBG] Request path /connect/token matched to endpoint type Token
2025-12-23 16:47:19.053 +08:00 [DBG] Endpoint enabled: Token, successfully created handler: Duende.IdentityServer.Endpoints.TokenEndpoint
2025-12-23 16:47:19.054 +08:00 [INF] Invoking IdentityServer endpoint: Duende.IdentityServer.Endpoints.TokenEndpoint for /connect/token
2025-12-23 16:47:19.056 +08:00 [DBG] Start token request.
2025-12-23 16:47:19.057 +08:00 [DBG] Start client validation
2025-12-23 16:47:19.058 +08:00 [DBG] Start parsing Basic Authentication secret
2025-12-23 16:47:19.059 +08:00 [DBG] Start parsing for secret in post body
2025-12-23 16:47:19.063 +08:00 [DBG] client id without secret found
2025-12-23 16:47:19.063 +08:00 [DBG] Parser found secret: PostBodySecretParser
2025-12-23 16:47:19.063 +08:00 [DBG] Secret id found: uc_localhost_5174
2025-12-23 16:47:19.064 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.064 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.064 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.064 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.064 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.064 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.066 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.067 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.067 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.067 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.067 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.068 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.068 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.068 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.068 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.068 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.069 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.070 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.070 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.070 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.070 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.071 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.071 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.071 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.071 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.071 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.072 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.072 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.072 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.072 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.072 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.073 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.073 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.073 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.073 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.073 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.074 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.074 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.074 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.074 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.074 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.075 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.075 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.075 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.075 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.075 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.076 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.076 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.076 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.076 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.077 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.078 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 11ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 10ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 8ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 7ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 6ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 5ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.078 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 4ms reading results.
2025-12-23 16:47:19.078 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.079 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 3ms reading results.
2025-12-23 16:47:19.079 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.079 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 2ms reading results.
2025-12-23 16:47:19.079 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.079 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.079 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.079 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.079 +08:00 [DBG] uc_localhost_5174 found in database: true
2025-12-23 16:47:19.079 +08:00 [DBG] client configuration validation for client uc_localhost_5174 succeeded.
2025-12-23 16:47:19.079 +08:00 [DBG] Public Client - skipping secret validation success
2025-12-23 16:47:19.080 +08:00 [DBG] Client validation success
2025-12-23 16:47:19.080 +08:00 [INF] {"ClientId":"uc_localhost_5174","AuthenticationMethod":"NoSecret","Category":"Authentication","Name":"Client Authentication Success","EventType":"Success","Id":1010,"Message":null,"ActivityId":"80000b11-0000-f500-b63f-84710c7967bb","TimeStamp":"2025-12-23T08:47:19.0803986","ProcessId":9484,"LocalIpAddress":"172.16.68.16:443","RemoteIpAddress":"172.16.8.121","$type":"ClientAuthenticationSuccessEvent"}
2025-12-23 16:47:19.083 +08:00 [DBG] Start token request validation
2025-12-23 16:47:19.086 +08:00 [DBG] Start validation of authorization code token request
2025-12-23 16:47:19.090 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'IdentityServerPersistedGrantDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:19.090 +08:00 [DBG] Compiling query expression: 
'DbSet<PersistedGrant>()
    .AsNoTracking()
    .Where(x => x.Key == __key_0)'
2025-12-23 16:47:19.095 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<PersistedGrant>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__key_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__key_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        PersistedGrant entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            PersistedGrant instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(PersistedGrant);
            (object)dataReader.GetInt64(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]: 
                        {
                            return 
                            {
                                PersistedGrant instance;
                                instance = new PersistedGrant();
                                instance.<Id>k__BackingField = dataReader.GetInt64(0);
                                instance.<ClientId>k__BackingField = dataReader.GetString(1);
                                instance.<ConsumedTime>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                instance.<CreationTime>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Data>k__BackingField = dataReader.GetString(4);
                                instance.<Description>k__BackingField = dataReader.IsDBNull(5) ? default(string) : dataReader.GetString(5);
                                instance.<Expiration>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                instance.<Key>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SessionId>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                instance.<SubjectId>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<Type>k__BackingField = dataReader.GetString(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(PersistedGrant)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt64(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        return entity;
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerPersistedGrantDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:19.096 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:19.096 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:19.096 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.097 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.097 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.097 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.097 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.097 +08:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__key_0
2025-12-23 16:47:19.098 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__key_0
2025-12-23 16:47:19.098 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.099 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.099 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.099 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.099 +08:00 [DBG] 50906375EE8BB4FA89CF246EC1B31CFD4EE47521C9155C9E559409971855003F found in database: true
2025-12-23 16:47:19.109 +08:00 [DBG] Compiling query expression: 
'DbSet<PersistedGrant>()
    .Where(x => x.Key == __key_0)'
2025-12-23 16:47:19.113 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<PersistedGrant>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__key_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: PersistedGrant.Id (long) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: PersistedGrant.ClientId (string) Required Index MaxLength(200), 1], [Property: PersistedGrant.ConsumedTime (DateTime?) Index, 2], [Property: PersistedGrant.CreationTime (DateTime) Required, 3], [Property: PersistedGrant.Data (string) Required MaxLength(50000), 4], [Property: PersistedGrant.Description (string) MaxLength(200), 5], [Property: PersistedGrant.Expiration (DateTime?) Index, 6], [Property: PersistedGrant.Key (string) Index MaxLength(200), 7], [Property: PersistedGrant.SessionId (string) Index MaxLength(100), 8], [Property: PersistedGrant.SubjectId (string) Index MaxLength(200), 9], [Property: PersistedGrant.Type (string) Required Index MaxLength(50), 10] }
        SELECT p.Id, p.ClientId, p.ConsumedTime, p.CreationTime, p.Data, p.Description, p.Expiration, p.Key, p.SessionId, p.SubjectId, p.Type
        FROM PersistedGrants AS p
        WHERE p.Key == @__key_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        PersistedGrant entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            PersistedGrant instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(PersistedGrant);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: PersistedGrant.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt64(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (PersistedGrant)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]: 
                        {
                            return 
                            {
                                PersistedGrant instance;
                                instance = new PersistedGrant();
                                instance.<Id>k__BackingField = dataReader.GetInt64(0);
                                instance.<ClientId>k__BackingField = dataReader.GetString(1);
                                instance.<ConsumedTime>k__BackingField = dataReader.IsDBNull(2) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(2);
                                instance.<CreationTime>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Data>k__BackingField = dataReader.GetString(4);
                                instance.<Description>k__BackingField = dataReader.IsDBNull(5) ? default(string) : dataReader.GetString(5);
                                instance.<Expiration>k__BackingField = dataReader.IsDBNull(6) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(6);
                                instance.<Key>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SessionId>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                instance.<SubjectId>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<Type>k__BackingField = dataReader.GetString(10);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: PersistedGrant | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Duende.IdentityServer.EntityFramework.Entities.PersistedGrant")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(PersistedGrant)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.IdentityServerPersistedGrantDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:19.114 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.114 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.114 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.114 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.114 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.114 +08:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__key_0
2025-12-23 16:47:19.116 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__key_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[Id], [p].[ClientId], [p].[ConsumedTime], [p].[CreationTime], [p].[Data], [p].[Description], [p].[Expiration], [p].[Key], [p].[SessionId], [p].[SubjectId], [p].[Type]
FROM [PersistedGrants] AS [p]
WHERE [p].[Key] = @__key_0
2025-12-23 16:47:19.117 +08:00 [DBG] Context 'IdentityServerPersistedGrantDbContext' started tracking 'PersistedGrant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:19.117 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.117 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 1ms reading results.
2025-12-23 16:47:19.117 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.117 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.117 +08:00 [DBG] removing 50906375EE8BB4FA89CF246EC1B31CFD4EE47521C9155C9E559409971855003F persisted grant from database
2025-12-23 16:47:19.118 +08:00 [DBG] An entity of type 'PersistedGrant' tracked by 'IdentityServerPersistedGrantDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:19.119 +08:00 [DBG] SaveChanges starting for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:19.119 +08:00 [DBG] DetectChanges starting for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:19.119 +08:00 [DBG] DetectChanges completed for 'IdentityServerPersistedGrantDbContext'.
2025-12-23 16:47:19.126 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.126 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.126 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.126 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.126 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.126 +08:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [PersistedGrants]
OUTPUT 1
WHERE [Id] = @p0;
2025-12-23 16:47:19.130 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [PersistedGrants]
OUTPUT 1
WHERE [Id] = @p0;
2025-12-23 16:47:19.131 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.131 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.131 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.131 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.133 +08:00 [DBG] An entity of type 'PersistedGrant' tracked by 'IdentityServerPersistedGrantDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:19.133 +08:00 [DBG] SaveChanges completed for 'IdentityServerPersistedGrantDbContext' with 1 entities written to the database.
2025-12-23 16:47:19.134 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.134 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.134 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.134 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.134 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.134 +08:00 [DBG] Executing DbCommand [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
WHERE [i].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:19.136 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[Created], [i].[Description], [i].[DisplayName], [i].[Emphasize], [i].[Enabled], [i].[Name], [i].[NonEditable], [i].[Required], [i].[ShowInDiscoveryDocument], [i].[Updated], [i0].[Id], [i0].[IdentityResourceId], [i0].[Type], [i1].[Id], [i1].[IdentityResourceId], [i1].[Key], [i1].[Value]
FROM [IdentityResources] AS [i]
LEFT JOIN [IdentityResourceClaims] AS [i0] ON [i].[Id] = [i0].[IdentityResourceId]
LEFT JOIN [IdentityResourceProperties] AS [i1] ON [i].[Id] = [i1].[IdentityResourceId]
WHERE [i].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [i].[Id], [i0].[Id]
2025-12-23 16:47:19.137 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.137 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.137 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.137 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.137 +08:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2025-12-23 16:47:19.137 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.137 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.137 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.137 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.138 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.138 +08:00 [DBG] Executing DbCommand [Parameters=[@__names_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a1].[Id], [a1].[ApiResourceId], [a1].[Created], [a1].[Description], [a1].[Expiration], [a1].[Type], [a1].[Value], [a2].[Id], [a2].[ApiResourceId], [a2].[Scope], [a3].[Id], [a3].[ApiResourceId], [a3].[Type], [a4].[Id], [a4].[ApiResourceId], [a4].[Key], [a4].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a4] ON [a].[Id] = [a4].[ApiResourceId]
WHERE EXISTS (
    SELECT 1
    FROM [ApiResourceScopes] AS [a0]
    WHERE [a].[Id] = [a0].[ApiResourceId] AND [a0].[Scope] IN (
        SELECT [n].[value]
        FROM OPENJSON(@__names_0) WITH ([value] nvarchar(200) '$') AS [n]
    ))
ORDER BY [a].[Id], [a1].[Id], [a2].[Id], [a3].[Id]
2025-12-23 16:47:19.139 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__names_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AllowedAccessTokenSigningAlgorithms], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[RequireResourceIndicator], [a].[ShowInDiscoveryDocument], [a].[Updated], [a1].[Id], [a1].[ApiResourceId], [a1].[Created], [a1].[Description], [a1].[Expiration], [a1].[Type], [a1].[Value], [a2].[Id], [a2].[ApiResourceId], [a2].[Scope], [a3].[Id], [a3].[ApiResourceId], [a3].[Type], [a4].[Id], [a4].[ApiResourceId], [a4].[Key], [a4].[Value]
FROM [ApiResources] AS [a]
LEFT JOIN [ApiResourceSecrets] AS [a1] ON [a].[Id] = [a1].[ApiResourceId]
LEFT JOIN [ApiResourceScopes] AS [a2] ON [a].[Id] = [a2].[ApiResourceId]
LEFT JOIN [ApiResourceClaims] AS [a3] ON [a].[Id] = [a3].[ApiResourceId]
LEFT JOIN [ApiResourceProperties] AS [a4] ON [a].[Id] = [a4].[ApiResourceId]
WHERE EXISTS (
    SELECT 1
    FROM [ApiResourceScopes] AS [a0]
    WHERE [a].[Id] = [a0].[ApiResourceId] AND [a0].[Scope] IN (
        SELECT [n].[value]
        FROM OPENJSON(@__names_0) WITH ([value] nvarchar(200) '$') AS [n]
    ))
ORDER BY [a].[Id], [a1].[Id], [a2].[Id], [a3].[Id]
2025-12-23 16:47:19.139 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.139 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.139 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.139 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.139 +08:00 [DBG] Found [] API resources in database
2025-12-23 16:47:19.140 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.140 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.140 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.140 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.140 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.140 +08:00 [DBG] Executing DbCommand [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
WHERE [a].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:19.141 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__scopes_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[Created], [a].[Description], [a].[DisplayName], [a].[Emphasize], [a].[Enabled], [a].[LastAccessed], [a].[Name], [a].[NonEditable], [a].[Required], [a].[ShowInDiscoveryDocument], [a].[Updated], [a0].[Id], [a0].[ScopeId], [a0].[Type], [a1].[Id], [a1].[Key], [a1].[ScopeId], [a1].[Value]
FROM [ApiScopes] AS [a]
LEFT JOIN [ApiScopeClaims] AS [a0] ON [a].[Id] = [a0].[ScopeId]
LEFT JOIN [ApiScopeProperties] AS [a1] ON [a].[Id] = [a1].[ScopeId]
WHERE [a].[Name] IN (
    SELECT [s].[value]
    FROM OPENJSON(@__scopes_0) WITH ([value] nvarchar(200) '$') AS [s]
)
ORDER BY [a].[Id], [a0].[Id]
2025-12-23 16:47:19.141 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.142 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.142 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.142 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.142 +08:00 [DBG] Found [] scopes in database
2025-12-23 16:47:19.143 +08:00 [DBG] Client required a proof key for code exchange. Starting PKCE validation
2025-12-23 16:47:19.144 +08:00 [DBG] Entity Framework Core 9.0.4 initialized 'AdminIdentityDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: MigrationsAssembly=Skoruba.Duende.IdentityServer.Admin.EntityFramework.Configuration EngineType=SqlServer 
2025-12-23 16:47:19.145 +08:00 [DBG] Creating DbConnection.
2025-12-23 16:47:19.145 +08:00 [DBG] Created DbConnection. (0ms).
2025-12-23 16:47:19.145 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.145 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.145 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.145 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.145 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.145 +08:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-12-23 16:47:19.146 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2025-12-23 16:47:19.147 +08:00 [DBG] Context 'AdminIdentityDbContext' started tracking 'UserIdentity' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-12-23 16:47:19.147 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.147 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.147 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.147 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.147 +08:00 [DBG] Validation of authorization code token request success
2025-12-23 16:47:19.148 +08:00 [INF] Token request validation success, {"ClientId":"uc_localhost_5174","ClientName":"Localhost Dev (5174)","GrantType":"authorization_code","Scopes":null,"AuthorizationCode":"****AA-1","RefreshToken":"********","UserName":null,"AuthenticationContextReferenceClasses":null,"Tenant":null,"IdP":null,"Raw":{"grant_type":"authorization_code","redirect_uri":"http://localhost:5174/demo?tab=uc-sso&callback=true","code":"***REDACTED***","code_verifier":"4acbcb9126be48d9ad34671c2778923f51072f4c799d4d6d9949a7b980420eb4712db817813d4c9b91ee38684209f953","client_id":"uc_localhost_5174"},"$type":"TokenRequestValidationLog"}
2025-12-23 16:47:19.153 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.153 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.153 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.153 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.153 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.153 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.155 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[AbsoluteRefreshTokenLifetime], [c].[AccessTokenLifetime], [c].[AccessTokenType], [c].[AllowAccessTokensViaBrowser], [c].[AllowOfflineAccess], [c].[AllowPlainTextPkce], [c].[AllowRememberConsent], [c].[AllowedIdentityTokenSigningAlgorithms], [c].[AlwaysIncludeUserClaimsInIdToken], [c].[AlwaysSendClientClaims], [c].[AuthorizationCodeLifetime], [c].[BackChannelLogoutSessionRequired], [c].[BackChannelLogoutUri], [c].[CibaLifetime], [c].[ClientClaimsPrefix], [c].[ClientId], [c].[ClientName], [c].[ClientUri], [c].[ConsentLifetime], [c].[CoordinateLifetimeWithUserSession], [c].[Created], [c].[DPoPClockSkew], [c].[DPoPValidationMode], [c].[Description], [c].[DeviceCodeLifetime], [c].[EnableLocalLogin], [c].[Enabled], [c].[FrontChannelLogoutSessionRequired], [c].[FrontChannelLogoutUri], [c].[IdentityTokenLifetime], [c].[IncludeJwtId], [c].[InitiateLoginUri], [c].[LastAccessed], [c].[LogoUri], [c].[NonEditable], [c].[PairWiseSubjectSalt], [c].[PollingInterval], [c].[ProtocolType], [c].[PushedAuthorizationLifetime], [c].[RefreshTokenExpiration], [c].[RefreshTokenUsage], [c].[RequireClientSecret], [c].[RequireConsent], [c].[RequireDPoP], [c].[RequirePkce], [c].[RequirePushedAuthorization], [c].[RequireRequestObject], [c].[SlidingRefreshTokenLifetime], [c].[UpdateAccessTokenClaimsOnRefresh], [c].[Updated], [c].[UserCodeType], [c].[UserSsoLifetime]
FROM [Clients] AS [c]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.155 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.155 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.155 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.155 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c0].[Id], [c0].[ClientId], [c0].[Origin], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientCorsOrigins] AS [c0] ON [c].[Id] = [c0].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.156 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.157 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.157 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.157 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[ClientId], [c1].[GrantType], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientGrantTypes] AS [c1] ON [c].[Id] = [c1].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.158 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.158 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.158 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.158 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.159 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c2].[Id], [c2].[ClientId], [c2].[Scope], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientScopes] AS [c2] ON [c].[Id] = [c2].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.159 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.159 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.160 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.160 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c3].[Id], [c3].[ClientId], [c3].[Type], [c3].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientClaims] AS [c3] ON [c].[Id] = [c3].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.161 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.161 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.161 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.161 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.162 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c4].[Id], [c4].[ClientId], [c4].[Created], [c4].[Description], [c4].[Expiration], [c4].[Type], [c4].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientSecrets] AS [c4] ON [c].[Id] = [c4].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.162 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.162 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.162 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.162 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.163 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c5].[Id], [c5].[ClientId], [c5].[Provider], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientIdPRestrictions] AS [c5] ON [c].[Id] = [c5].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.163 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.163 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.163 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.163 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c6].[Id], [c6].[ClientId], [c6].[PostLogoutRedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientPostLogoutRedirectUris] AS [c6] ON [c].[Id] = [c6].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.164 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.164 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.164 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.164 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c7].[Id], [c7].[ClientId], [c7].[Key], [c7].[Value], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientProperties] AS [c7] ON [c].[Id] = [c7].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.165 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.165 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.165 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.165 +08:00 [DBG] Executing DbCommand [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__clientId_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT [c8].[Id], [c8].[ClientId], [c8].[RedirectUri], [c].[Id]
FROM [Clients] AS [c]
INNER JOIN [ClientRedirectUris] AS [c8] ON [c].[Id] = [c8].[ClientId]
WHERE [c].[ClientId] = @__clientId_0
ORDER BY [c].[Id]
2025-12-23 16:47:19.166 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 11ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 10ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 8ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 7ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 6ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 5ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 4ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 2ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 1ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.167 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.167 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.167 +08:00 [DBG] uc_localhost_5174 found in database: true
2025-12-23 16:47:19.168 +08:00 [DBG] client configuration validation for client uc_localhost_5174 succeeded.
2025-12-23 16:47:19.171 +08:00 [DBG] Getting claims for access token for client: uc_localhost_5174
2025-12-23 16:47:19.172 +08:00 [DBG] Getting claims for access token for subject: 1bd29909-68f6-4442-bd5b-242240d49a47
2025-12-23 16:47:19.187 +08:00 [DBG] Compiling query expression: 
'DbSet<UserIdentityUserClaim>()
    .Where(uc => uc.UserId.Equals(__user_Id_0))
    .Select(c => c.ToClaim())'
2025-12-23 16:47:19.193 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Claim>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: UserIdentityUserClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserIdentityUserClaim.ClaimType (string), 1], [Property: UserIdentityUserClaim.ClaimValue (string), 2], [Property: UserIdentityUserClaim.UserId (string) Required FK Index, 3] }
        SELECT u.Id, u.ClaimType, u.ClaimValue, u.UserId
        FROM UserClaims AS u
        WHERE u.UserId == @__user_Id_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: UserIdentityUserClaim.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: UserIdentityUserClaim.ClaimType (string), 1], [Property: UserIdentityUserClaim.ClaimValue (string), 2], [Property: UserIdentityUserClaim.UserId (string) Required FK Index, 3] }
        SELECT u.Id, u.ClaimType, u.ClaimValue, u.UserId
        FROM UserClaims AS u
        WHERE u.UserId == @__user_Id_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        UserIdentityUserClaim entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            UserIdentityUserClaim instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(UserIdentityUserClaim);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: UserIdentityUserClaim.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentityUserClaim").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (UserIdentityUserClaim)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: UserIdentityUserClaim | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentityUserClaim")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: UserIdentityUserClaim | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentityUserClaim")]: 
                        {
                            return 
                            {
                                UserIdentityUserClaim instance;
                                instance = new UserIdentityUserClaim();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ClaimType>k__BackingField = dataReader.IsDBNull(1) ? default(string) : dataReader.GetString(1);
                                instance.<ClaimValue>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                instance.<UserId>k__BackingField = dataReader.GetString(3);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: UserIdentityUserClaim | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.Entities.Identity.UserIdentityUserClaim")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(UserIdentityUserClaim)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity.ToClaim();
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.AdminIdentityDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:19.195 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.195 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.195 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.195 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.195 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.195 +08:00 [DBG] Executing DbCommand [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ClaimType], [u].[ClaimValue], [u].[UserId]
FROM [UserClaims] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2025-12-23 16:47:19.197 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[ClaimType], [u].[ClaimValue], [u].[UserId]
FROM [UserClaims] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2025-12-23 16:47:19.197 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.197 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.197 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.197 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.203 +08:00 [DBG] Compiling query expression: 
'DbSet<UserIdentityUserRole>()
    .Join(
        inner: DbSet<UserIdentityRole>(), 
        outerKeySelector: userRole => userRole.RoleId, 
        innerKeySelector: role => role.Id, 
        resultSelector: (userRole, role) => new { 
            userRole = userRole, 
            role = role
         })
    .Where(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.userRole.UserId.Equals(__userId_0))
    .Select(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.role.Name)'
2025-12-23 16:47:19.211 +08:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<string>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT r.Name
        FROM UserRoles AS u
        INNER JOIN Roles AS r ON u.RoleId == r.Id
        WHERE u.UserId == @__userId_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT r.Name
        FROM UserRoles AS u
        INNER JOIN Roles AS r ON u.RoleId == r.Id
        WHERE u.UserId == @__userId_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        string value1;
        value1 = dataReader.IsDBNull(0) ? default(string) : dataReader.GetString(0);
        return value1;
    }, 
    contextType: Skoruba.Duende.IdentityServer.Admin.EntityFramework.Shared.DbContexts.AdminIdentityDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-12-23 16:47:19.212 +08:00 [DBG] Opening connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.212 +08:00 [DBG] Opened connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.212 +08:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-12-23 16:47:19.212 +08:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.212 +08:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-12-23 16:47:19.212 +08:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [UserRoles] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-12-23 16:47:19.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Name]
FROM [UserRoles] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[UserId] = @__userId_0
2025-12-23 16:47:19.213 +08:00 [DBG] Closing data reader to 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.213 +08:00 [DBG] A data reader for 'IdentitySysDB' on server '172.16.38.11' is being disposed after spending 0ms reading results.
2025-12-23 16:47:19.213 +08:00 [DBG] Closing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.213 +08:00 [DBG] Closed connection to database 'IdentitySysDB' on server '172.16.38.11' (0ms).
2025-12-23 16:47:19.251 +08:00 [INF] {"Details":"System.Security.Cryptography.CryptographicException: \r\n   at System.Security.Cryptography.CngKey.Open(String keyName, CngProvider provider, CngKeyOpenOptions openOptions)\r\n   at System.Security.Cryptography.X509Certificates.CertificatePal.GetPrivateKey[T](Func`2 createCsp, Func`2 createCng)\r\n   at System.Security.Cryptography.X509Certificates.CertificateExtensionsCommon.GetPrivateKey[T](X509Certificate2 certificate, Predicate`1 matchesConstraints)\r\n   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKey()\r\n   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKeyStatus()\r\n   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider.FoundPrivateKey(SecurityKey key)\r\n   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures)\r\n   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures, CryptoProviderFactory cryptoProviderFactory)\r\n   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateSignatureProvider(SecurityKey key, String algorithm, Boolean willCreateSignatures, Boolean cacheProvider)\r\n   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm, Boolean cacheProvider)\r\n   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm)\r\n   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateSignature(ReadOnlySpan`1 data, Span`1 destination, SigningCredentials signingCredentials, Int32& bytesWritten)\r\n   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SecurityTokenDescriptor tokenDescriptor)\r\n   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SigningCredentials signingCredentials, IDictionary`2 additionalHeaderClaims)\r\n   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateJwtAsync(Token token, String payload, Dictionary`2 headerElements) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 139\r\n   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 73\r\n   at Duende.IdentityServer.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenService.cs:line 250\r\n   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.CreateAccessTokenAsync(ValidatedTokenRequest request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 428\r\n   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessTokenRequestAsync(TokenRequestValidationResult validationResult) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 325\r\n   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAuthorizationCodeRequestAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 134\r\n   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 91\r\n   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessTokenRequestAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 139\r\n   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 77\r\n   at Duende.IdentityServer.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IdentityServerOptions options, IEndpointRouter router, IUserSession userSession, IEventService events, IIssuerNameService issuerNameService, ISessionCoordinationService sessionCoordinationService) in /_/identity-server/src/IdentityServer/Hosting/IdentityServerMiddleware.cs:line 114","Category":"Error","Name":"Unhandled Exception","EventType":"Error","Id":3000,"Message":"","ActivityId":"80000b11-0000-f500-b63f-84710c7967bb","TimeStamp":"2025-12-23T08:47:19.2513093","ProcessId":9484,"LocalIpAddress":"172.16.68.16:443","RemoteIpAddress":"172.16.8.121","$type":"UnhandledExceptionEvent"}
2025-12-23 16:47:19.252 +08:00 [FTL] Unhandled exception: 
System.Security.Cryptography.CryptographicException: 
   at System.Security.Cryptography.CngKey.Open(String keyName, CngProvider provider, CngKeyOpenOptions openOptions)
   at System.Security.Cryptography.X509Certificates.CertificatePal.GetPrivateKey[T](Func`2 createCsp, Func`2 createCng)
   at System.Security.Cryptography.X509Certificates.CertificateExtensionsCommon.GetPrivateKey[T](X509Certificate2 certificate, Predicate`1 matchesConstraints)
   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKey()
   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKeyStatus()
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider.FoundPrivateKey(SecurityKey key)
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures)
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures, CryptoProviderFactory cryptoProviderFactory)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateSignatureProvider(SecurityKey key, String algorithm, Boolean willCreateSignatures, Boolean cacheProvider)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm, Boolean cacheProvider)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateSignature(ReadOnlySpan`1 data, Span`1 destination, SigningCredentials signingCredentials, Int32& bytesWritten)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SecurityTokenDescriptor tokenDescriptor)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SigningCredentials signingCredentials, IDictionary`2 additionalHeaderClaims)
   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateJwtAsync(Token token, String payload, Dictionary`2 headerElements) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 139
   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 73
   at Duende.IdentityServer.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenService.cs:line 250
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.CreateAccessTokenAsync(ValidatedTokenRequest request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 428
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessTokenRequestAsync(TokenRequestValidationResult validationResult) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 325
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAuthorizationCodeRequestAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 134
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 91
   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessTokenRequestAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 139
   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 77
   at Duende.IdentityServer.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IdentityServerOptions options, IEndpointRouter router, IUserSession userSession, IEventService events, IIssuerNameService issuerNameService, ISessionCoordinationService sessionCoordinationService) in /_/identity-server/src/IdentityServer/Hosting/IdentityServerMiddleware.cs:line 114
2025-12-23 16:47:19.253 +08:00 [ERR] Connection ID "17654110540902959888", Request ID "80000b11-0000-f500-b63f-84710c7967bb": An unhandled exception was thrown by the application.
System.Security.Cryptography.CryptographicException: 
   at System.Security.Cryptography.CngKey.Open(String keyName, CngProvider provider, CngKeyOpenOptions openOptions)
   at System.Security.Cryptography.X509Certificates.CertificatePal.GetPrivateKey[T](Func`2 createCsp, Func`2 createCng)
   at System.Security.Cryptography.X509Certificates.CertificateExtensionsCommon.GetPrivateKey[T](X509Certificate2 certificate, Predicate`1 matchesConstraints)
   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKey()
   at Microsoft.IdentityModel.Tokens.X509SecurityKey.get_PrivateKeyStatus()
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider.FoundPrivateKey(SecurityKey key)
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures)
   at Microsoft.IdentityModel.Tokens.AsymmetricSignatureProvider..ctor(SecurityKey key, String algorithm, Boolean willCreateSignatures, CryptoProviderFactory cryptoProviderFactory)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateSignatureProvider(SecurityKey key, String algorithm, Boolean willCreateSignatures, Boolean cacheProvider)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm, Boolean cacheProvider)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateForSigning(SecurityKey key, String algorithm)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateSignature(ReadOnlySpan`1 data, Span`1 destination, SigningCredentials signingCredentials, Int32& bytesWritten)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SecurityTokenDescriptor tokenDescriptor)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.CreateToken(String payload, SigningCredentials signingCredentials, IDictionary`2 additionalHeaderClaims)
   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateJwtAsync(Token token, String payload, Dictionary`2 headerElements) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 139
   at Duende.IdentityServer.Services.DefaultTokenCreationService.CreateTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenCreationService.cs:line 73
   at Duende.IdentityServer.Services.DefaultTokenService.CreateSecurityTokenAsync(Token token) in /_/identity-server/src/IdentityServer/Services/Default/DefaultTokenService.cs:line 250
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.CreateAccessTokenAsync(ValidatedTokenRequest request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 428
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessTokenRequestAsync(TokenRequestValidationResult validationResult) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 325
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAuthorizationCodeRequestAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 134
   at Duende.IdentityServer.ResponseHandling.TokenResponseGenerator.ProcessAsync(TokenRequestValidationResult request) in /_/identity-server/src/IdentityServer/ResponseHandling/Default/TokenResponseGenerator.cs:line 91
   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessTokenRequestAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 139
   at Duende.IdentityServer.Endpoints.TokenEndpoint.ProcessAsync(HttpContext context) in /_/identity-server/src/IdentityServer/Endpoints/TokenEndpoint.cs:line 77
   at Duende.IdentityServer.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IdentityServerOptions options, IEndpointRouter router, IUserSession userSession, IEventService events, IIssuerNameService issuerNameService, ISessionCoordinationService sessionCoordinationService) in /_/identity-server/src/IdentityServer/Hosting/IdentityServerMiddleware.cs:line 114
   at Duende.IdentityServer.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IdentityServerOptions options, IEndpointRouter router, IUserSession userSession, IEventService events, IIssuerNameService issuerNameService, ISessionCoordinationService sessionCoordinationService) in /_/identity-server/src/IdentityServer/Hosting/IdentityServerMiddleware.cs:line 136
   at Duende.IdentityServer.Hosting.MutualTlsEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in /_/identity-server/src/IdentityServer/Hosting/MutualTlsEndpointMiddleware.cs:line 118
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Duende.IdentityServer.Hosting.DynamicProviders.DynamicSchemeAuthenticationMiddleware.Invoke(HttpContext context) in /_/identity-server/src/IdentityServer/Hosting/DynamicProviders/DynamicSchemes/DynamicSchemeAuthenticationMiddleware.cs:line 50
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>g__InvokeCoreAwaited|15_0(HttpContext context, Task`1 policyTask)
   at Duende.IdentityServer.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in /_/identity-server/src/IdentityServer/Hosting/BaseUrlMiddleware.cs:line 23
   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1.ProcessRequestAsync()
2025-12-23 16:47:19.256 +08:00 [DBG] 'AdminIdentityDbContext' disposed.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:19.256 +08:00 [DBG] 'IdentityServerPersistedGrantDbContext' disposed.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:19.256 +08:00 [DBG] 'IdentityServerConfigurationDbContext' disposed.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposing connection to database 'IdentitySysDB' on server '172.16.38.11'.
2025-12-23 16:47:19.256 +08:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-12-23 16:47:19.256 +08:00 [INF] Request finished HTTP/2 POST https://prs.uccapital.com.tw/sts/connect/token - 500 null null 226.3643ms
